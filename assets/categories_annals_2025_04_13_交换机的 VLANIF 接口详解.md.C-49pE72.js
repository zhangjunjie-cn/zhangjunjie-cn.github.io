import{_ as F}from"./chunks/ArticleMetadata.C66F8Bik.js";import{_ as E,P as A,z as B,A as e,B as a,G as l,ap as t,O as r,b as n,Q as i,S as m,aG as h}from"./chunks/framework.DfjUQpHG.js";import"./chunks/index.Deh-lfQt.js";import"./chunks/theme.YC-CoK4p.js";import"./chunks/dayjs.min.CQ4ZiC03.js";const S=JSON.parse('{"title":"交换机的 VLANIF 接口详解","description":"","frontmatter":{"date":"2025/04/13 19:05","isTop":false,"title":"交换机的 VLANIF 接口详解","author":"张俊杰","articleGPT":"这是一篇关于","categories":["博客"],"tags":["交换机"]},"headers":[],"relativePath":"categories/annals/2025/04/13/交换机的 VLANIF 接口详解.md","filePath":"categories/annals/2025/04/13/交换机的 VLANIF 接口详解.md","lastUpdated":1744556240000}'),C={name:"categories/annals/2025/04/13/交换机的 VLANIF 接口详解.md"};function y(o,s,f,V,N,D){const d=F,b=A("ClientOnly"),p=A("Mermaid"),u=A("NolebaseGitContributors"),g=A("NolebaseGitChangelog");return e(),B("div",null,[s[8]||(s[8]=a("h1",{id:"交换机的-vlanif-接口详解",tabindex:"-1"},[n("交换机的 VLANIF 接口详解 "),a("a",{class:"header-anchor",href:"#交换机的-vlanif-接口详解","aria-label":'Permalink to "交换机的 VLANIF 接口详解"'},"​")],-1)),l(b,null,{default:i(()=>{var k,c;return[(((k=o.$frontmatter)==null?void 0:k.aside)??!0)&&(((c=o.$frontmatter)==null?void 0:c.showArticleMetadata)??!0)?(e(),r(d,{key:0,article:o.$frontmatter},null,8,["article"])):m("",!0)]}),_:1}),s[9]||(s[9]=t('<h2 id="🎯-vlanif-是什么" tabindex="-1">🎯 VLANIF 是什么？ <a class="header-anchor" href="#🎯-vlanif-是什么" aria-label="Permalink to &quot;🎯 VLANIF 是什么？&quot;">​</a></h2><p>VLANIF（VLAN Interface）是三层交换机或路由器上创建的<strong>虚拟三层接口</strong>，也称为 SVI（Switch Virtual Interface）。它不是物理接口，而是为 VLAN 创建的虚拟逻辑接口。</p><h2 id="🔍-vlanif-的特性" tabindex="-1">🔍 VLANIF 的特性 <a class="header-anchor" href="#🔍-vlanif-的特性" aria-label="Permalink to &quot;🔍 VLANIF 的特性&quot;">​</a></h2><ol><li><p><strong>虚拟三层接口</strong>：</p><ul><li>🖥️ 工作在 OSI 模型的第三层（网络层）</li><li>🔌 可以配置 IP 地址，作为该 VLAN 的网关</li><li>🌉 实现不同 VLAN 之间的通信</li></ul></li><li><p><strong>与物理接口的区别</strong>：</p><ul><li>🔧 物理接口是实际存在的硬件端口</li><li>🧩 VLANIF 是逻辑上创建的软件接口</li></ul></li></ol><h2 id="❓-为什么可以配置多个-vlanif" tabindex="-1">❓ 为什么可以配置多个 VLANIF？ <a class="header-anchor" href="#❓-为什么可以配置多个-vlanif" aria-label="Permalink to &quot;❓ 为什么可以配置多个 VLANIF？&quot;">​</a></h2><p>可以配置多个 VLANIF 的原因包括：</p>',6)),a("ol",null,[s[2]||(s[2]=a("li",null,[a("p",null,[a("strong",null,"支持多个 VLAN 的三层通信"),n("：")]),a("ul",null,[a("li",null,"🏷️ 每个 VLAN 可以有自己的 VLANIF 接口"),a("li",null,"📌 例如：VLAN 10 对应 VLANIF 10，VLAN 20 对应 VLANIF 20")])],-1)),a("li",null,[s[1]||(s[1]=a("p",null,[a("strong",null,"实现 VLAN 间路由"),n("：")],-1)),(e(),r(h,null,{default:i(()=>[l(p,{id:"mermaid-81",class:"mermaid",graph:"graph%20LR%0A%20%20PC1(VLAN%2010)%20--%3E%7CVLANIF%2010%7C%20Switch%0A%20%20PC2(VLAN%2020)%20--%3E%7CVLANIF%2020%7C%20Switch%0A%20%20Switch%20--%3E%20Router%0A"})]),fallback:i(()=>s[0]||(s[0]=[n(" Loading... ")])),_:1}))]),s[3]||(s[3]=a("li",null,[a("p",null,[a("strong",null,"灵活的网络规划"),n("：")]),a("ul",null,[a("li",null,"🌐 不同 VLAN 可以使用不同网段的 IP 地址"),a("li",null,"🛡️ 便于实施访问控制策略")])],-1))]),s[10]||(s[10]=t(`<h2 id="💡-vlanif-的-ip-地址性质" tabindex="-1">💡 VLANIF 的 IP 地址性质 <a class="header-anchor" href="#💡-vlanif-的-ip-地址性质" aria-label="Permalink to &quot;💡 VLANIF 的 IP 地址性质&quot;">​</a></h2><ol><li><p><strong>是虚拟地址但功能完整</strong>：</p><ul><li>🎭 虽然是逻辑上配置的地址</li><li>💪 但具有完整的三层功能，可以收发 IP 数据包</li></ul></li><li><p><strong>典型配置示例</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes one-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#F69D50;">interface</span><span style="--shiki-light:#50A14F;--shiki-dark:#96D0FF;"> Vlanif10</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#F69D50;"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#96D0FF;"> address</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;"> 192.168.10.1</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;"> 255.255.255.0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#F47067;">!</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#F69D50;">interface</span><span style="--shiki-light:#50A14F;--shiki-dark:#96D0FF;"> Vlanif20</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#F69D50;"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#96D0FF;"> address</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;"> 192.168.20.1</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;"> 255.255.255.0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li><li><p><strong>实际应用场景</strong>：</p><ul><li>🚪 作为 VLAN 内主机的默认网关</li><li>🛣️ 用于 VLAN 之间的路由转发</li><li>🌍 实现与外部网络的三层通信</li></ul></li></ol><h2 id="🏁-总结" tabindex="-1">🏁 总结 <a class="header-anchor" href="#🏁-总结" aria-label="Permalink to &quot;🏁 总结&quot;">​</a></h2><p>VLANIF 是三层交换机上为 VLAN 创建的虚拟三层接口，虽然本身是逻辑接口，但具有完整的 IP 功能。可以配置多个 VLANIF 是为了支持多个 VLAN 的三层通信需求，每个 VLANIF 通常对应一个不同的 IP 子网，作为该 VLAN 内主机的网关。</p><h2 id="🏗️-vlan-interface-虚拟局域网接口" tabindex="-1">🏗️ VLAN Interface（虚拟局域网接口） <a class="header-anchor" href="#🏗️-vlan-interface-虚拟局域网接口" aria-label="Permalink to &quot;🏗️ VLAN Interface（虚拟局域网接口）&quot;">​</a></h2><p>VLAN Interface是一种虚拟的网络接口，它允许在交换机上创建虚拟的网络，从而实现网络隔离和安全控制，提高网络的安全性和性能。</p><blockquote><p>以下是一个简单的VLAN Interface架构图，看懂Vlanif，如果觉得图例太小了，右上角可以切换阅读视图。</p></blockquote>`,7)),(e(),r(h,null,{default:i(()=>[l(p,{id:"mermaid-168",class:"mermaid",graph:"graph%20TD%0A%20%20%20%20%25%25%20%E5%AE%9A%E4%B9%89%E6%A0%B7%E5%BC%8F%0A%20%20%20%20classDef%20switch%20fill%3A%23f9f%2Cstroke%3A%23333%2Cstroke-width%3A2px%3B%0A%20%20%20%20classDef%20vlanif%20fill%3A%23bbf%2Cstroke%3A%23333%2Cstroke-dasharray%3A%205%3B%0A%20%20%20%20classDef%20pc%20fill%3A%239f9%2Cstroke%3A%23333%3B%0A%20%20%20%20classDef%20router%20fill%3A%23f96%2Cstroke%3A%23333%3B%0A%0A%20%20%20%20%25%25%20%E4%BA%92%E8%81%94%E7%BD%91%0A%20%20%20%20Internet%5B%F0%9F%8C%8D%20%E4%BA%92%E8%81%94%E7%BD%91%5D%0A%20%20%20%20%0A%20%20%20%20%25%25%20%E8%B7%AF%E7%94%B1%E5%99%A8%0A%20%20%20%20Router%5B%F0%9F%9B%B0%EF%B8%8F%20%E8%B7%AF%E7%94%B1%E5%99%A8%3Cbr%2F%3E192.168.30.254%5D%3A%3A%3Arouter%0A%20%20%20%20Router%20--%3E%20Internet%0A%0A%20%20%20%20%25%25%20%E6%A0%B8%E5%BF%83%E4%BA%A4%E6%8D%A2%E6%9C%BA%0A%20%20%20%20CoreSW%5B%F0%9F%94%80%20%E6%A0%B8%E5%BF%83%E4%BA%A4%E6%8D%A2%E6%9C%BA%5D%3A%3A%3Aswitch%0A%20%20%20%20VLANIF30%5BVLANIF30%3Cbr%2F%3E192.168.30.1%5D%3A%3A%3Avlanif%0A%20%20%20%20VLANIF20%5BVLANIF20%3Cbr%2F%3E192.168.20.1%5D%3A%3A%3Avlanif%0A%20%20%20%20VLANIF10%5BVLANIF10%3Cbr%2F%3E192.168.10.1%5D%3A%3A%3Avlanif%0A%20%20%20%20%0A%20%20%20%20CoreSW%20---%20VLANIF30%20%26%20VLANIF20%20%26%20VLANIF10%0A%20%20%20%20VLANIF30%20---%20Router%0A%0A%20%20%20%20%25%25%20%E6%8E%A5%E5%85%A5%E4%BA%A4%E6%8D%A2%E6%9C%BA%0A%20%20%20%20AccSW1%5B%E6%8E%A5%E5%85%A5%E4%BA%A4%E6%8D%A2%E6%9C%BA1%5D%3A%3A%3Aswitch%0A%20%20%20%20AccSW2%5B%E6%8E%A5%E5%85%A5%E4%BA%A4%E6%8D%A2%E6%9C%BA2%5D%3A%3A%3Aswitch%0A%20%20%20%20%0A%20%20%20%20CoreSW%20--%20Trunk%20---%20AccSW1%0A%20%20%20%20CoreSW%20--%20Trunk%20---%20AccSW2%0A%0A%20%20%20%20%25%25%20%E7%BB%88%E7%AB%AF%E8%AE%BE%E5%A4%87%0A%20%20%20%20PC1%5B%F0%9F%92%BB%20PC1%3Cbr%2F%3E192.168.10.2%5D%3A%3A%3Apc%0A%20%20%20%20PC2%5B%F0%9F%92%BB%20PC2%3Cbr%2F%3E192.168.10.3%5D%3A%3A%3Apc%0A%20%20%20%20PC3%5B%F0%9F%92%BB%20PC3%3Cbr%2F%3E192.168.20.2%5D%3A%3A%3Apc%0A%20%20%20%20PC4%5B%F0%9F%92%BB%20PC4%3Cbr%2F%3E192.168.20.3%5D%3A%3A%3Apc%0A%20%20%20%20%0A%20%20%20%20AccSW1%20--%20Access%20VLAN10%20---%20PC1%20%26%20PC2%0A%20%20%20%20AccSW2%20--%20Access%20VLAN20%20---%20PC3%20%26%20PC4%0A%0A%20%20%20%20%25%25%20%E6%A0%87%E6%B3%A8%E8%AF%B4%E6%98%8E%0A%20%20%20%20note1%5B%22%E2%96%B8%20%E5%90%8C%E4%B8%80VLAN%E9%80%9A%E4%BF%A1%EF%BC%9APC1%E2%86%92PC2%E7%9B%B4%E6%8E%A5%E4%BA%8C%E5%B1%82%E8%BD%AC%E5%8F%91%22%5D%0A%20%20%20%20note2%5B%22%E2%96%B8%20%E8%B7%A8VLAN%E9%80%9A%E4%BF%A1%EF%BC%9A%3Cbr%2F%3EPC1%E2%86%92PC3%E9%9C%80%E7%BB%8FVLANIF%E8%B7%AF%E7%94%B1%22%5D%0A%20%20%20%20note3%5B%22%E2%96%B8%20%E5%A4%96%E7%BD%91%E8%AE%BF%E9%97%AE%EF%BC%9APC1%E2%86%92%E4%BA%92%E8%81%94%E7%BD%91%E7%BB%8FVLANIF10%E2%86%92VLANIF30%22%5D%0A"})]),fallback:i(()=>s[4]||(s[4]=[n(" Loading... ")])),_:1})),s[11]||(s[11]=t('<div class="important custom-block github-alert"><p class="custom-block-title">IMPORTANT</p><p>在这张拓扑图中，<strong>只有 VLANIF 30 直接连接路由器并通往外网</strong>，但其他 VLANIF 接口（如 VLANIF &gt;10/20）也可以通过路由转发间接访问外网。以下是详细解释：</p></div><hr><h3 id="🔑-关键点解析" tabindex="-1">🔑 关键点解析： <a class="header-anchor" href="#🔑-关键点解析" aria-label="Permalink to &quot;🔑 关键点解析：&quot;">​</a></h3><ol><li><p><strong>VLANIF 30 的特殊性</strong>：</p><ul><li>🎯 是核心交换机与路由器之间的<strong>专属网关接口</strong></li><li>📡 配置了与路由器直连的 IP 段（<code>192.168.30.0/24</code>）</li><li>🚀 承担所有 VLAN 访问外网的<strong>出口角色</strong></li></ul></li><li><p><strong>其他 VLANIF 的访问路径</strong>：</p></li></ol>',4)),(e(),r(h,null,{default:i(()=>[l(p,{id:"mermaid-207",class:"mermaid",graph:"graph%20LR%0A%20%20%20%20%25%25%20%E6%9B%B4%E7%B4%A7%E5%87%91%E7%9A%84%E8%B7%A8VLAN%E8%AE%BF%E9%97%AE%E8%B7%AF%E5%BE%84%0A%20%20%20%20PC1%5B%F0%9F%92%BB%20PC1%5D%20--%3E%7C1.%E7%BD%91%E5%85%B3%E6%8C%87%E5%90%91%3Cbr%2F%3EVLANIF10%7C%20VLANIF10%0A%20%20%20%20VLANIF10%20--%3E%7C2.%E8%B7%AF%E7%94%B1%E6%9F%A5%E6%89%BE%7C%20VLANIF30%0A%20%20%20%20VLANIF30%20--%3E%7C3.%E8%BD%AC%E5%8F%91%E8%87%B3%7C%20Router%5B%F0%9F%9B%B0%EF%B8%8F%20%E8%B7%AF%E7%94%B1%E5%99%A8%5D%0A%20%20%20%20%0A%20%20%20%20%25%25%20%E6%B7%BB%E5%8A%A0%E5%BC%AF%E6%8A%98%E6%8E%A7%E5%88%B6%E7%82%B9%0A%20%20%20%20classDef%20invisible%20fill%3Anone%2Cstroke%3Anone%2Cwidth%3A0%2Cheight%3A0%0A%20%20%20%20node1%3A%3A%3Ainvisible%0A%20%20%20%20node2%3A%3A%3Ainvisible%0A%20%20%20%20%0A%20%20%20%20VLANIF10%20--%3E%20node1%0A%20%20%20%20node1%20--%3E%7C%E9%9A%90%E8%97%8F%E8%8A%82%E7%82%B9%3Cbr%2F%3E%E6%8E%A7%E5%88%B6%E5%B8%83%E5%B1%80%7C%20node2%0A%20%20%20%20node2%20--%3E%20VLANIF30%0A%20%20%20%20%0A%20%20%20%20%25%25%20%E6%A0%B7%E5%BC%8F%E4%BC%98%E5%8C%96%0A%20%20%20%20style%20PC1%20fill%3A%239f9%0A%20%20%20%20style%20VLANIF10%2CVLANIF30%20fill%3A%23bbf%2Cstroke-dasharray%3A3%0A%20%20%20%20style%20Router%20fill%3A%23f96%0A%20%20%20%20linkStyle%200%2C1%2C2%2C3%20stroke%3A%23666%2Cstroke-width%3A2px%0A"})]),fallback:i(()=>s[5]||(s[5]=[n(" Loading... ")])),_:1})),s[12]||(s[12]=t('<ol start="3"><li><strong>路由表示例</strong>：<table tabindex="0"><thead><tr><th>目标网络</th><th>下一跳</th><th>出口接口</th></tr></thead><tbody><tr><td>192.168.10.0/24</td><td>Direct</td><td>VLANIF10</td></tr><tr><td>192.168.20.0/24</td><td>Direct</td><td>VLANIF20</td></tr><tr><td>0.0.0.0/0</td><td>192.168.30.254</td><td>VLANIF30</td></tr></tbody></table></li></ol><hr><h3 id="🤔-为什么这样设计" tabindex="-1">🤔 为什么这样设计？ <a class="header-anchor" href="#🤔-为什么这样设计" aria-label="Permalink to &quot;🤔 为什么这样设计？&quot;">​</a></h3><ol><li><p><strong>安全隔离</strong>：</p><ul><li>🔒 外网流量统一从 VLANIF 30 出口</li><li>🛡️ 可在该接口集中配置 ACL/NAT 等安全策略</li></ul></li><li><p><strong>简化管理</strong>：</p><div class="language-cisco vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cisco</span><pre class="shiki shiki-themes one-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span>ip route 0.0.0.0 0.0.0.0 192.168.30.254</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>🎯 一条默认路由即可让所有 VLAN 访问外网</p></li><li><p><strong>典型业务流示例</strong>：</p><ul><li><strong>PC1 访问百度</strong>： <ol><li>PC1 检查目标 IP 不在本地子网</li><li>将数据包发给默认网关 VLANIF10</li><li>核心交换机通过默认路由转发到 VLANIF30</li><li>路由器执行 NAT 后发送到互联网</li></ol></li></ul></li></ol><hr><h3 id="🔄-如果需要其他-vlanif-也能直连外网" tabindex="-1">🔄 如果需要其他 VLANIF 也能直连外网？ <a class="header-anchor" href="#🔄-如果需要其他-vlanif-也能直连外网" aria-label="Permalink to &quot;🔄 如果需要其他 VLANIF 也能直连外网？&quot;">​</a></h3><p>可以修改设计为：</p>',7)),(e(),r(h,null,{default:i(()=>[l(p,{id:"mermaid-338",class:"mermaid",graph:"graph%20TD%0A%20%20%20%20VLANIF10%20--%3E%20Router%0A%20%20%20%20VLANIF20%20--%3E%20Router%0A%20%20%20%20VLANIF30%20--%3E%20Router%0A"})]),fallback:i(()=>s[6]||(s[6]=[n(" Loading... ")])),_:1})),s[13]||(s[13]=t(`<p>但这样会导致：</p><ul><li>⚠️ 需要配置更多物理链路或子接口</li><li>⚠️ 增加路由策略复杂度</li><li>⚠️ 不利于统一安全控制</li></ul><p>✅ 建议保持原设计的单出口架构，这是企业网络的最佳实践。</p><p>以下是实现该拓扑的完整配置命令示例（以华为交换机为例）：</p><hr><h3 id="🛠️-1-核心交换机配置" tabindex="-1">🛠️ <strong>1. 核心交换机配置</strong> <a class="header-anchor" href="#🛠️-1-核心交换机配置" aria-label="Permalink to &quot;🛠️ **1. 核心交换机配置**&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes one-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#768390;--shiki-dark-font-style:inherit;"># 创建VLAN</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#F47067;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">Huawei</span><span style="--shiki-light:#383A42;--shiki-dark:#F47067;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;"> system-view</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[Huawei] sysname CoreSwitch</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch] vlan batch 10 20 30</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#768390;--shiki-dark-font-style:inherit;"># 配置VLANIF接口</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch] interface Vlanif 10</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch-Vlanif10] ip address 192.168.10.1 24</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch-Vlanif10] quit</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch] interface Vlanif 20</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch-Vlanif20] ip address 192.168.20.1 24</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch-Vlanif20] quit</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch] interface Vlanif 30</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch-Vlanif30] ip address 192.168.30.1 24</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch-Vlanif30] quit</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#768390;--shiki-dark-font-style:inherit;"># 配置默认路由（指向路由器）</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch] ip route-static 0.0.0.0 0 192.168.30.254</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#768390;--shiki-dark-font-style:inherit;"># 配置连接接入交换机的Trunk端口（以G0/0/1为例）</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch] interface GigabitEthernet 0/0/1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch-GigabitEthernet0/0/1] port link-type trunk</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch-GigabitEthernet0/0/1] port trunk allow-pass vlan 10 20</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch-GigabitEthernet0/0/1] quit</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#768390;--shiki-dark-font-style:inherit;"># 配置连接路由器的Access端口（以G0/0/24为例）</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch] interface GigabitEthernet 0/0/24</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch-GigabitEthernet0/0/24] port link-type access</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch-GigabitEthernet0/0/24] port default vlan 30</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[CoreSwitch-GigabitEthernet0/0/24] quit</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><hr><h3 id="🛠️-2-接入交换机配置-以接入交换机1为例" tabindex="-1">🛠️ <strong>2. 接入交换机配置（以接入交换机1为例）</strong> <a class="header-anchor" href="#🛠️-2-接入交换机配置-以接入交换机1为例" aria-label="Permalink to &quot;🛠️ **2. 接入交换机配置（以接入交换机1为例）**&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes one-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#768390;--shiki-dark-font-style:inherit;"># 创建VLAN</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#F47067;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">Huawei</span><span style="--shiki-light:#383A42;--shiki-dark:#F47067;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;"> system-view</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[Huawei] sysname AccessSwitch1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[AccessSwitch1] vlan 10</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#768390;--shiki-dark-font-style:inherit;"># 配置连接PC的Access端口（以G0/0/1-2为例）</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[AccessSwitch1] interface GigabitEthernet 0/0/1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[AccessSwitch1-GigabitEthernet0/0/1] port link-type access</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[AccessSwitch1-GigabitEthernet0/0/1] port default vlan 10</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[AccessSwitch1-GigabitEthernet0/0/1] quit</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[AccessSwitch1] interface GigabitEthernet 0/0/2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[AccessSwitch1-GigabitEthernet0/0/2] port link-type access</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[AccessSwitch1-GigabitEthernet0/0/2] port default vlan 10</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[AccessSwitch1-GigabitEthernet0/0/2] quit</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#768390;--shiki-dark-font-style:inherit;"># 配置连接核心交换机的Trunk端口（以G0/0/24为例）</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[AccessSwitch1] interface GigabitEthernet 0/0/24</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[AccessSwitch1-GigabitEthernet0/0/24] port link-type trunk</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[AccessSwitch1-GigabitEthernet0/0/24] port trunk allow-pass vlan 10</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[AccessSwitch1-GigabitEthernet0/0/24] quit</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><hr><h3 id="🛠️-3-路由器配置-以华为ar路由器为例" tabindex="-1">🛠️ <strong>3. 路由器配置（以华为AR路由器为例）</strong> <a class="header-anchor" href="#🛠️-3-路由器配置-以华为ar路由器为例" aria-label="Permalink to &quot;🛠️ **3. 路由器配置（以华为AR路由器为例）**&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes one-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#F47067;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">Huawei</span><span style="--shiki-light:#383A42;--shiki-dark:#F47067;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;"> system-view</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[Huawei] sysname Router</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[Router] interface GigabitEthernet 0/0/0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[Router-GigabitEthernet0/0/0] ip address 192.168.30.254 24</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[Router-GigabitEthernet0/0/0] quit</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#768390;--shiki-dark-font-style:inherit;"># 配置NAT实现外网访问（假设外网接口为G0/0/1）</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[Router] interface GigabitEthernet 0/0/1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[Router-GigabitEthernet0/0/1] ip address 公网IP 掩码</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[Router-GigabitEthernet0/0/1] quit</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[Router] acl number 2000</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[Router-acl-basic-2000] rule permit source 192.168.0.0 0.0.255.255</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[Router-acl-basic-2000] quit</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[Router] nat address-group 1 公网IP 公网IP</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[Router] interface GigabitEthernet 0/0/1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[Router-GigabitEthernet0/0/1] nat outbound 2000 address-group 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[Router-GigabitEthernet0/0/1] quit</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#768390;--shiki-dark-font-style:inherit;"># 回程路由（非必须，根据实际网络添加）</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[Router] ip route-static 192.168.10.0 24 192.168.30.1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">[Router] ip route-static 192.168.20.0 24 192.168.30.1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><hr><h3 id="🛠️-4-pc配置-以windows为例" tabindex="-1">🛠️ <strong>4. PC配置（以Windows为例）</strong> <a class="header-anchor" href="#🛠️-4-pc配置-以windows为例" aria-label="Permalink to &quot;🛠️ **4. PC配置（以Windows为例）**&quot;">​</a></h3><div class="language-powershell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes one-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#768390;--shiki-dark-font-style:inherit;"># PC1配置：</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">netsh interface ip set address </span><span style="--shiki-light:#50A14F;--shiki-dark:#96D0FF;">&quot;以太网&quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#F47067;"> static</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;"> 192.168</span><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">.</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;">10.2</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;"> 255.255</span><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">.</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;">255.0</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;"> 192.168</span><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">.</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;">10.1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#768390;--shiki-dark-font-style:inherit;"># PC3配置：</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">netsh interface ip set address </span><span style="--shiki-light:#50A14F;--shiki-dark:#96D0FF;">&quot;以太网&quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#F47067;"> static</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;"> 192.168</span><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">.</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;">20.2</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;"> 255.255</span><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">.</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;">255.0</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;"> 192.168</span><span style="--shiki-light:#383A42;--shiki-dark:#ADBAC7;">.</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;">20.1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><hr><h3 id="📌-关键配置说明" tabindex="-1">📌 关键配置说明： <a class="header-anchor" href="#📌-关键配置说明" aria-label="Permalink to &quot;📌 关键配置说明：&quot;">​</a></h3><table tabindex="0"><thead><tr><th>配置项</th><th>作用</th></tr></thead><tbody><tr><td><code>port trunk allow-pass vlan</code></td><td>允许指定VLAN通过Trunk链路</td></tr><tr><td><code>ip route-static 0.0.0.0 0</code></td><td>默认路由，使所有非本地流量指向VLANIF30</td></tr><tr><td><code>nat outbound</code></td><td>实现内网地址到公网地址的转换</td></tr><tr><td><code>port default vlan</code></td><td>将Access端口划入指定VLAN</td></tr></tbody></table><blockquote><p>💡 <strong>调试技巧</strong>：<br> 在核心交换机上使用 <code>display ip routing-table</code> 查看路由表，使用 <code>ping -a 192.168.10.1 8.8.8.8</code> 测试外网连通性。</p></blockquote><h2 id="⚠️-注意" tabindex="-1">⚠️ 注意 <a class="header-anchor" href="#⚠️-注意" aria-label="Permalink to &quot;⚠️ 注意&quot;">​</a></h2><div class="warning custom-block github-alert"><p class="custom-block-title">WARNING</p><p></p><ol><li>🔌 接入交换机不必写一条静态到核心的交换机；</li><li>🌉 三层交换机的 Vlanif 默认互通，写一个 Vlanif 地址静态路由到边界路由即可；</li><li>🕳️ 路由黑洞，</li><li>⚠️ 三层交换机的 Vlanif 地址不能和边界路由的地址冲突；</li><li>🌍 外网流量统一控制。</li></ol></div><h2 id="🔧-技术容错" tabindex="-1">🔧 技术容错 <a class="header-anchor" href="#🔧-技术容错" aria-label="Permalink to &quot;🔧 技术容错&quot;">​</a></h2><p>如果你觉得交换机多vlanif接入边界出口路由比较好使， 可以考虑以下技术容错方案：</p><ol><li><strong>冗余设计</strong>： <ul><li>🔄 部署多个核心交换机，每个交换机上配置不同的 VLANIF</li></ul></li></ol>`,25)),(e(),r(h,null,{default:i(()=>[l(p,{id:"mermaid-495",class:"mermaid",graph:"graph%20TD%0A%20%20%20%20%25%25%20%E6%AF%8F%E4%B8%AAVLANIF%E4%BD%BF%E7%94%A8%E7%8B%AC%E7%AB%8B%E7%89%A9%E7%90%86%E7%AB%AF%E5%8F%A3%0A%20%20%20%20CoreSW%5B%F0%9F%94%80%20%E6%A0%B8%E5%BF%83%E4%BA%A4%E6%8D%A2%E6%9C%BA%5D%20--%20GE0%2F0%2F1%20--%3E%20Router%0A%20%20%20%20CoreSW%20--%20GE0%2F0%2F2%20--%3E%20Router%0A%20%20%20%20CoreSW%20--%20GE0%2F0%2F3%20--%3E%20Router%0A%20%20%20%20VLANIF10%20-.%20%E7%BB%91%E5%AE%9AGE0%2F0%2F1%20.-%3E%20Router%0A%20%20%20%20VLANIF20%20-.%20%E7%BB%91%E5%AE%9AGE0%2F0%2F2%20.-%3E%20Router%0A%20%20%20%20VLANIF30%20-.%20%E7%BB%91%E5%AE%9AGE0%2F0%2F3%20.-%3E%20Router%0A"})]),fallback:i(()=>s[7]||(s[7]=[n(" Loading... ")])),_:1})),s[14]||(s[14]=t(`<h3 id="🎯-何时可以考虑多vlanif直连" tabindex="-1">🎯 <strong>何时可以考虑多VLANIF直连？</strong> <a class="header-anchor" href="#🎯-何时可以考虑多vlanif直连" aria-label="Permalink to &quot;🎯 **何时可以考虑多VLANIF直连？**&quot;">​</a></h3><h4 id="适用场景-需同时满足" tabindex="-1">适用场景（需同时满足）： <a class="header-anchor" href="#适用场景-需同时满足" aria-label="Permalink to &quot;适用场景（需同时满足）：&quot;">​</a></h4><ul><li><strong>严格流量隔离需求</strong>：如金融网络要求生产/办公流量物理隔离</li><li><strong>多ISP出口</strong>：VLAN10走电信，VLAN20走联通</li><li><strong>法规合规要求</strong>：如等保三级中&quot;安全区域边界隔离&quot;</li></ul><h4 id="实施建议" tabindex="-1">实施建议： <a class="header-anchor" href="#实施建议" aria-label="Permalink to &quot;实施建议：&quot;">​</a></h4><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes one-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#768390;--shiki-dark-font-style:inherit;"># 采用子接口替代物理端口（节省硬件资源）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#F69D50;">interface</span><span style="--shiki-light:#50A14F;--shiki-dark:#96D0FF;"> GigabitEthernet0/0/0.10</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#F69D50;"> dot1q</span><span style="--shiki-light:#50A14F;--shiki-dark:#96D0FF;"> termination</span><span style="--shiki-light:#50A14F;--shiki-dark:#96D0FF;"> vid</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;"> 10</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#F69D50;"> ip</span><span style="--shiki-light:#50A14F;--shiki-dark:#96D0FF;"> address</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;"> 192.168.10.1</span><span style="--shiki-light:#986801;--shiki-dark:#6CB6FF;"> 24</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><hr><p>您最初看到的建议实质是 <strong>网络架构的KISS原则</strong>（Keep It Simple, Stupid）的体现。多VLANIF直连路由器虽然功能上能实现，但会引入不必要的复杂度。企业网络设计应优先考虑：</p><ol><li><strong>管理便捷性</strong></li><li><strong>故障可预测性</strong></li><li><strong>策略一致性</strong></li><li><strong>资源利用率</strong></li></ol><p>这种设计差异类似于城市交通规划：单出口架构像所有车辆通过一座立交桥出城（易管理），多VLANIF直连像为每个小区修独立出城道路（成本高且维护难）。</p>`,9)),l(u),l(g)])}const q=E(C,[["render",y]]);export{S as __pageData,q as default};
