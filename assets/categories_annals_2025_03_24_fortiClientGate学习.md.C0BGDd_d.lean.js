import{_ as u}from"./chunks/ArticleGPT.DcRZmdDi.js";import{_ as p}from"./chunks/ArticleMetadata.CccXcOgE.js";import{_ as b,z as s,A as m,B as l,c as _,G as r,S as f,M as P,P as G,ap as C,O as e}from"./chunks/framework.DX_QNVSv.js";import"./chunks/index.zebejNkg.js";import"./chunks/theme.ChJNmxi9.js";const B=JSON.parse('{"title":"FortiClientGate路由配置","description":"","frontmatter":{"date":"2025/03/24 16:04","isTop":true,"title":"FortiClientGate路由配置","author":"张俊杰","articleGPT":"这是一篇关于在FortiClientGate中配置和使用路由的文章。文章介绍了如何在FortiClientGate中创建和配置路由，以及如何在FortiClientGate中访问这些路由。文章还讨论了路由的安全性和管理，以及如何使用FortiClientGate的组策略来控制路由的访问权限。","categories":["博客"],"tags":["防火墙路由"]},"headers":[],"relativePath":"categories/annals/2025/03/24/fortiClientGate学习.md","filePath":"categories/annals/2025/03/24/fortiClientGate学习.md","lastUpdated":1743046853000}'),q={name:"categories/annals/2025/03/24/fortiClientGate学习.md"};function N(o,t,x,k,F,y){const i=p,d=e("ClientOnly"),g=u,h=e("NolebaseGitContributors"),c=e("NolebaseGitChangelog");return s(),m("div",null,[t[0]||(t[0]=l("h1",{id:"forticlientgate-路由配置",tabindex:"-1"},[_("FortiClientGate 路由配置 "),l("a",{class:"header-anchor",href:"#forticlientgate-路由配置","aria-label":'Permalink to "FortiClientGate 路由配置"'},"​")],-1)),r(d,null,{default:f(()=>{var n,a;return[(((n=o.$frontmatter)==null?void 0:n.aside)??!0)&&(((a=o.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(s(),P(i,{key:0,article:o.$frontmatter},null,8,["article"])):G("",!0)]}),_:1}),r(g),t[1]||(t[1]=C('<p>防火墙策略（Firewall Policy）和路由（Routing）是网络通信中两个核心但功能不同的机制，主要区别如下：</p><hr><h2 id="_1-核心功能" tabindex="-1"><strong>1. 核心功能</strong> <a class="header-anchor" href="#_1-核心功能" aria-label="Permalink to &quot;**1. 核心功能**&quot;">​</a></h2><table tabindex="0"><thead><tr><th><strong>维度</strong></th><th><strong>防火墙策略</strong></th><th><strong>路由</strong></th></tr></thead><tbody><tr><td><strong>主要目的</strong></td><td><strong>控制流量是否允许通过</strong>（安全过滤）</td><td><strong>决定流量如何转发</strong>（路径选择）</td></tr><tr><td><strong>工作层级</strong></td><td>主要基于 <strong>传输层（L4）和应用层（L7）</strong>（如协议、端口、应用类型）</td><td>基于 <strong>网络层（L3）</strong>（如目标IP、子网）</td></tr><tr><td><strong>决策依据</strong></td><td>源/目的IP、端口、协议、用户身份、应用类型、时间等</td><td>目标IP、子网掩码、路由协议（如OSPF、BGP）、下一跳网关、度量值（Metric）</td></tr><tr><td><strong>动作类型</strong></td><td><code>允许/拒绝</code>（可能记录日志）</td><td><code>转发到某接口/网关</code>（无权限控制）</td></tr></tbody></table><hr><h2 id="_2-应用场景对比" tabindex="-1"><strong>2. 应用场景对比</strong> <a class="header-anchor" href="#_2-应用场景对比" aria-label="Permalink to &quot;**2. 应用场景对比**&quot;">​</a></h2><table tabindex="0"><thead><tr><th><strong>场景</strong></th><th><strong>防火墙策略</strong></th><th><strong>路由</strong></th></tr></thead><tbody><tr><td><strong>阻止外部攻击</strong></td><td>拒绝来自恶意IP的访问</td><td>不涉及（路由无法过滤流量）</td></tr><tr><td><strong>VPN流量分流</strong></td><td>允许特定用户通过VPN访问内网</td><td>将VPN流量导向隧道接口</td></tr><tr><td><strong>限制员工上网行为</strong></td><td>禁止访问社交媒体</td><td>确保访问互联网的流量走默认网关</td></tr><tr><td><strong>服务器保护</strong></td><td>仅开放80/443端口</td><td>将服务器流量路由到DMZ区域</td></tr></tbody></table><hr><h2 id="_3-技术特性对比" tabindex="-1"><strong>3. 技术特性对比</strong> <a class="header-anchor" href="#_3-技术特性对比" aria-label="Permalink to &quot;**3. 技术特性对比**&quot;">​</a></h2><table tabindex="0"><thead><tr><th><strong>特性</strong></th><th><strong>防火墙策略</strong></th><th><strong>路由</strong></th></tr></thead><tbody><tr><td><strong>状态感知</strong></td><td>支持（可跟踪连接状态，如TCP握手）</td><td>无状态（仅根据IP转发）</td></tr><tr><td><strong>NAT支持</strong></td><td>通常集成（如源NAT、目的NAT）</td><td>不直接支持（需依赖防火墙或路由器附加功能）</td></tr><tr><td><strong>策略优先级</strong></td><td>按顺序匹配（首条匹配生效）</td><td>最长前缀匹配（最精确的子网优先）</td></tr><tr><td><strong>配置位置</strong></td><td>防火墙设备（如FortiGate）、终端防护软件（如FortiClient）</td><td>路由器、三层交换机、主机路由表</td></tr></tbody></table><hr><h2 id="_4-协作关系" tabindex="-1"><strong>4. 协作关系</strong> <a class="header-anchor" href="#_4-协作关系" aria-label="Permalink to &quot;**4. 协作关系**&quot;">​</a></h2><p>虽然功能不同，但两者协同工作：</p><ol><li><strong>路由先生效</strong>：决定流量去向（如发送到防火墙或直接转发）。</li><li><strong>防火墙后生效</strong>：对到达的流量进行安全过滤。</li></ol><p><strong>示例</strong>：</p><ul><li>流量访问 <code>10.1.1.1</code> → 路由表将其导向防火墙 → 防火墙策略检查是否放行。</li></ul><hr><h2 id="_5-常见误区" tabindex="-1"><strong>5. 常见误区</strong> <a class="header-anchor" href="#_5-常见误区" aria-label="Permalink to &quot;**5. 常见误区**&quot;">​</a></h2><ul><li><strong>误区1</strong>：<em>“路由可以替代防火墙”</em><br> → 路由仅决定路径，无法阻止攻击或过滤恶意流量。</li><li><strong>误区2</strong>：<em>“防火墙策略能修改下一跳”</em><br> → 防火墙只能允许/拒绝流量，路径修改需通过策略路由（Policy Routing）实现。</li></ul><hr><h2 id="总结" tabindex="-1"><strong>总结</strong> <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;**总结**&quot;">​</a></h2><ul><li><strong>防火墙策略</strong>是“交通警察”（检查是否放行），<strong>路由</strong>是“导航系统”（选择最佳路径）。</li><li>实际网络中，两者需配合使用：路由确保流量到达正确设备，防火墙确保流量安全合规。</li></ul><h2 id="问题" tabindex="-1">问题？ <a class="header-anchor" href="#问题" aria-label="Permalink to &quot;问题？&quot;">​</a></h2><h3 id="为什么防火墙策略可能不会生效" tabindex="-1"><strong>为什么防火墙策略可能不会生效？</strong> <a class="header-anchor" href="#为什么防火墙策略可能不会生效" aria-label="Permalink to &quot;**为什么防火墙策略可能不会生效？**&quot;">​</a></h3><p>即使你配置了防火墙策略，可能流量还是走不通，原因可能包括：</p><ol><li><p><strong>没有正确的静态路由</strong>（最常见的情况）</p><ul><li>防火墙策略允许访问，但如果 FortiGate 没有路由到目标网络，流量无法转发。</li><li><strong>检查静态路由（Network &gt; Static Routes），确保 FortiGate 知道如何到达目标网络。</strong></li></ul></li><li><p><strong>策略路由的优先级问题</strong></p><ul><li>如果已有静态路由能正确转发流量，就不需要策略路由。</li><li>但如果你有多条出口，想要特定流量走特定路径，就需要策略路由。</li></ul></li><li><p><strong>NAT 相关问题</strong>（如果涉及公网访问）</p><ul><li>如果是内网访问公网，通常需要在防火墙策略里<strong>启用 NAT</strong>，否则数据包可能不会被转换正确的源 IP。</li></ul></li><li><p><strong>回程流量问题</strong></p><ul><li>如果你的防火墙策略只允许单向流量，而没有放行回程流量，可能会导致连接失败。</li></ul></li></ol><hr><h3 id="如何排查" tabindex="-1"><strong>如何排查？</strong> <a class="header-anchor" href="#如何排查" aria-label="Permalink to &quot;**如何排查？**&quot;">​</a></h3><ol><li><strong>检查路由表</strong>：<code>get router info routing-table all</code></li><li><strong>测试路由可达性</strong>：<code>execute ping &lt;目标 IP&gt;</code></li><li><strong>查看防火墙日志</strong>：确定流量是否被策略拦截</li></ol><hr><h3 id="结论" tabindex="-1"><strong>结论</strong> <a class="header-anchor" href="#结论" aria-label="Permalink to &quot;**结论**&quot;">​</a></h3><p>✔ <strong>如果 FortiGate 通过静态路由或默认路由能找到正确的路径，不需要策略路由。</strong><br> ✔ <strong>如果有多条出口，或默认路由无法满足需求，就需要策略路由。</strong><br> ✔ <strong>防火墙策略负责流量允许与否，但路由决定流量去向，两者要结合配置！</strong></p><p>如果你遇到具体的流量问题，可以提供详细的拓扑和需求，我可以帮你分析要不要配置策略路由！</p>',33)),r(h),r(c)])}const M=b(q,[["render",N]]);export{B as __pageData,M as default};
