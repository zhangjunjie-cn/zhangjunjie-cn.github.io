<!DOCTYPE html>
<html lang="zh-CH" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>一文梳理Vue3核心原理-Justin3go's Blog-🖊</title>
    <meta name="description" content="坚持深耕技术领域的T型前端程序员, 喜欢Vuejs、Nestjs, 还会点python、nlp、web3、后端">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/assets/style.DeSp8ycZ.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.CSIaXqHF.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.Cbg5KFuQ.js">
    <link rel="modulepreload" href="/assets/chunks/framework.C_70-4oE.js">
    <link rel="modulepreload" href="/assets/chunks/WDocTitleMeta.DFYgHGyF.js">
    <link rel="modulepreload" href="/assets/博客_2023_02_04Vue3相关原理梳理.md.DYqRfGO6.lean.js">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MB7XVBG1TQ"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-MB7XVBG1TQ");</script>
    <script>var _hmt=_hmt||[];(function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?ea8a4869f485978692f89cd908f6906a";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})();</script>
    <link rel="icon" href="https://oss.justin3go.com/justin3goAvatar.ico">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
    <meta property="og:url" content="https://justin3go.com/博客/2023/02/04Vue3相关原理梳理.html">
    <meta property="og:title" content="一文梳理Vue3核心原理">
    <meta property="og:description" content="坚持深耕技术领域的T型前端程序员, 喜欢Vuejs、Nestjs, 还会点python、nlp、web3、后端">
    <meta property="og:image" content="https://justin3go.com/ava.jpg">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:description" content="坚持深耕技术领域的T型前端程序员, 喜欢Vuejs、Nestjs, 还会点python、nlp、web3、后端">
    <meta name="twitter:image:src" content="https://justin3go.com/ava.jpg">
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-db8121a0><!--[--><!--]--><!--[--><span tabindex="-1" data-v-68c56c97></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-68c56c97>Skip to content</a><!--]--><!----><header class="VPNav" data-v-db8121a0 data-v-ab895bd3><div class="VPNavBar" data-v-ab895bd3 data-v-1fead13d><div class="wrapper" data-v-1fead13d><div class="container" data-v-1fead13d><div class="title" data-v-1fead13d><div class="VPNavBarTitle has-sidebar" data-v-1fead13d data-v-93868083><a class="title" href="/" data-v-93868083><!--[--><!--]--><!----><span data-v-93868083>Justin3go&#39;s Blog-🖊</span><!--[--><!--]--></a></div></div><div class="content" data-v-1fead13d><div class="content-body" data-v-1fead13d><!--[--><!--]--><div class="VPNavBarSearch search" data-v-1fead13d><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-1fead13d data-v-ed2b9947><span id="main-nav-aria-label" class="visually-hidden" data-v-ed2b9947> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-ed2b9947 data-v-99655acc><!--[--><span data-v-99655acc>首页</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/博客/" tabindex="0" data-v-ed2b9947 data-v-99655acc><!--[--><span data-v-99655acc>博客</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/笔记/" tabindex="0" data-v-ed2b9947 data-v-99655acc><!--[--><span data-v-99655acc>笔记</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/pages/tags" tabindex="0" data-v-ed2b9947 data-v-99655acc><!--[--><span data-v-99655acc>标签</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/pages/posts" tabindex="0" data-v-ed2b9947 data-v-99655acc><!--[--><span data-v-99655acc>归档</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-ed2b9947 data-v-3ae2a2b3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-3ae2a2b3><span class="text" data-v-3ae2a2b3><!----><span data-v-3ae2a2b3>线上</span><span class="vpi-chevron-down text-icon" data-v-3ae2a2b3></span></span></button><div class="menu" data-v-3ae2a2b3><div class="VPMenu" data-v-3ae2a2b3 data-v-e48400d3><div class="items" data-v-e48400d3><!--[--><!--[--><div class="VPMenuGroup" data-v-e48400d3 data-v-b0f462d7><p class="title" data-v-b0f462d7>自建项目</p><!--[--><!--[--><div class="VPMenuLink" data-v-b0f462d7 data-v-aa1edd39><a class="VPLink link vp-external-link-icon" href="https://oss.justin3go.com/blogs/xiaoyou-mp-code.png" target="_blank" rel="noreferrer" data-v-aa1edd39><!--[--><span data-v-aa1edd39>笑友小程序</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-b0f462d7 data-v-aa1edd39><a class="VPLink link vp-external-link-icon" href="https://ssgo.app" target="_blank" rel="noreferrer" data-v-aa1edd39><!--[--><span data-v-aa1edd39>阿里云盘搜索</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-b0f462d7 data-v-aa1edd39><a class="VPLink link vp-external-link-icon" href="https://usesora.app" target="_blank" rel="noreferrer" data-v-aa1edd39><!--[--><span data-v-aa1edd39>Use Sora</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-b0f462d7 data-v-aa1edd39><a class="VPLink link vp-external-link-icon" href="https://bug404.dev" target="_blank" rel="noreferrer" data-v-aa1edd39><!--[--><span data-v-aa1edd39>Excel2JSON</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-e48400d3 data-v-b0f462d7><p class="title" data-v-b0f462d7>开源部署</p><!--[--><!--[--><div class="VPMenuLink" data-v-b0f462d7 data-v-aa1edd39><a class="VPLink link vp-external-link-icon" href="https://chat.justin3go.com/" target="_blank" rel="noreferrer" data-v-aa1edd39><!--[--><span data-v-aa1edd39>ChatGPT-Web</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-b0f462d7 data-v-aa1edd39><a class="VPLink link vp-external-link-icon" href="https://chatc.app" target="_blank" rel="noreferrer" data-v-aa1edd39><!--[--><span data-v-aa1edd39>LobeChat</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-1fead13d data-v-b7618dd9 data-v-3ae2a2b3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-3ae2a2b3><span class="text" data-v-3ae2a2b3><span class="vpi-languages option-icon" data-v-3ae2a2b3></span><!----><span class="vpi-chevron-down text-icon" data-v-3ae2a2b3></span></span></button><div class="menu" data-v-3ae2a2b3><div class="VPMenu" data-v-3ae2a2b3 data-v-e48400d3><!----><!--[--><!--[--><div class="items" data-v-b7618dd9><p class="title" data-v-b7618dd9>简体中文</p><!--[--><div class="VPMenuLink" data-v-b7618dd9 data-v-aa1edd39><a class="VPLink link vp-external-link-icon" href="https://en.justin3go.com/博客/2023/02/04Vue3相关原理梳理" target="_blank" rel="noreferrer" data-v-aa1edd39><!--[--><span data-v-aa1edd39>English</span><!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-1fead13d data-v-38766328><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-38766328 data-v-54fe4df0 data-v-49fc324b><span class="check" data-v-49fc324b><span class="icon" data-v-49fc324b><!--[--><span class="vpi-sun sun" data-v-54fe4df0></span><span class="vpi-moon moon" data-v-54fe4df0></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-1fead13d data-v-0986c3ab data-v-acd7b754><!--[--><a class="VPSocialLink no-icon" href="/feed.xml" aria-label target="_blank" rel="noopener" data-v-acd7b754 data-v-13282201><svg xmlns="http://www.w3.org/2000/svg" width="512" height="512" viewBox="0 0 512 512"><title>RSS订阅</title><path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z"/><path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z"/><path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-1fead13d data-v-32da1737 data-v-3ae2a2b3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-3ae2a2b3><span class="vpi-more-horizontal icon" data-v-3ae2a2b3></span></button><div class="menu" data-v-3ae2a2b3><div class="VPMenu" data-v-3ae2a2b3 data-v-e48400d3><!----><!--[--><!--[--><div class="group translations" data-v-32da1737><p class="trans-title" data-v-32da1737>简体中文</p><!--[--><div class="VPMenuLink" data-v-32da1737 data-v-aa1edd39><a class="VPLink link vp-external-link-icon" href="https://en.justin3go.com/博客/2023/02/04Vue3相关原理梳理" target="_blank" rel="noreferrer" data-v-aa1edd39><!--[--><span data-v-aa1edd39>English</span><!--]--></a></div><!--]--></div><div class="group" data-v-32da1737><div class="item appearance" data-v-32da1737><p class="label" data-v-32da1737>深色模式</p><div class="appearance-action" data-v-32da1737><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-32da1737 data-v-54fe4df0 data-v-49fc324b><span class="check" data-v-49fc324b><span class="icon" data-v-49fc324b><!--[--><span class="vpi-sun sun" data-v-54fe4df0></span><span class="vpi-moon moon" data-v-54fe4df0></span><!--]--></span></span></button></div></div></div><div class="group" data-v-32da1737><div class="item social-links" data-v-32da1737><div class="VPSocialLinks social-links-list" data-v-32da1737 data-v-acd7b754><!--[--><a class="VPSocialLink no-icon" href="/feed.xml" aria-label target="_blank" rel="noopener" data-v-acd7b754 data-v-13282201><svg xmlns="http://www.w3.org/2000/svg" width="512" height="512" viewBox="0 0 512 512"><title>RSS订阅</title><path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z"/><path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z"/><path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-1fead13d data-v-45a8a01c><span class="container" data-v-45a8a01c><span class="top" data-v-45a8a01c></span><span class="middle" data-v-45a8a01c></span><span class="bottom" data-v-45a8a01c></span></span></button></div></div></div></div><div class="divider" data-v-1fead13d><div class="divider-line" data-v-1fead13d></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-db8121a0 data-v-b0eff7f7><div class="container" data-v-b0eff7f7><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-b0eff7f7><span class="vpi-align-left menu-icon" data-v-b0eff7f7></span><span class="menu-text" data-v-b0eff7f7>目录</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-b0eff7f7 data-v-a9617a4e><button data-v-a9617a4e>👆Code is building the world.</button><!----></div></div></div><aside class="VPSidebar" data-v-db8121a0 data-v-ed5613a0><div class="curtain" data-v-ed5613a0></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-ed5613a0><span class="visually-hidden" id="sidebar-aria-label" data-v-ed5613a0> Sidebar Navigation </span><!--[--><!--[--><br><div flex="~ col gap-2"><!----><!----></div><!--]--><!--]--><!--[--><div class="no-transition group" data-v-8bd2d7b5><section class="VPSidebarItem level-0 collapsible" data-v-8bd2d7b5 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h2 class="text" data-v-6fca8b74>post</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><section class="VPSidebarItem level-1 collapsible" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h3 class="text" data-v-6fca8b74>ai中文</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/post/ai%E4%B8%AD%E6%96%87/01Java%E8%BF%B7%E5%AE%AB" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>Java迷宫</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/post/ai%E4%B8%AD%E6%96%87/ai-local-painting" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>AI 作画本地搭建</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-8bd2d7b5><section class="VPSidebarItem level-0 collapsible has-active" data-v-8bd2d7b5 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h2 class="text" data-v-6fca8b74>博客</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><section class="VPSidebarItem level-1 collapsible" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h3 class="text" data-v-6fca8b74>2020</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2020/01Java%E8%BF%B7%E5%AE%AB" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>01Java迷宫</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2020/02%E4%BD%BF%E7%94%A8anaconda%E4%B8%AD%E7%9A%84Prompt%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83%E7%9A%84%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>02使用anaconda中的Prompt配置虚拟环境的常用命令</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h3 class="text" data-v-6fca8b74>2021</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2021/01scrapy%E7%88%AC%E8%99%AB%E8%AF%A6%E8%A7%A3" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>01scrapy爬虫详解</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2021/02TFIDF%E8%AE%A1%E7%AE%97%E7%9A%84%E5%AD%A6%E4%B9%A0" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>02TFIDF计算的学习</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2021/03%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E6%A8%A1%E6%8B%9F%E7%A8%8B%E5%BA%8F" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>03操作系统内存分配模拟程序</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2021/04%E6%95%A3%E5%88%97%E8%A1%A8%E5%AE%9E%E7%8E%B0%E6%9F%A5%E6%89%BE" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>04散列表实现查找</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h3 class="text" data-v-6fca8b74>2022</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2022/01%E9%83%BD2022%E5%B9%B4%E4%BA%86%EF%BC%8C%E8%BF%98%E6%98%AF%E5%BE%97%E5%AD%A6%E5%9C%A3%E6%9D%AF%E5%B8%83%E5%B1%80%E4%B8%8E%E5%8F%8C%E9%A3%9E%E7%BF%BC%E5%B8%83%E5%B1%80" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>01都2022年了，还是得学圣杯布局与双飞翼布局</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2022/02TypeScript%E5%85%A5%E9%97%A8" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>02TypeScript入门</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2022/03%E8%BF%99%E9%81%93%E9%A2%98%E5%8E%9F%E6%9D%A5%E5%8F%AF%E4%BB%A5%E7%94%A8%E5%88%B0JS%E8%BF%99%E4%B9%88%E5%A4%9A%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%81" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>03这道题原来可以用到JS这么多知识点！</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2022/04git%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>04git常用操作</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2022/05%E5%89%8D%E7%AB%AF%E7%A8%8B%E5%BA%8F%E5%91%98%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84CodeIDE%EF%BC%88code-server%E6%95%99%E7%A8%8B%EF%BC%89" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>05前端程序员搭建自己的CodeIDE（code-server教程）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2022/06%E7%8E%A9%E8%BD%ACvitepress" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>06玩转vitepress</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2022/07IntersectionObserver%E5%AE%9E%E7%8E%B0%E6%A8%AA%E7%AB%96%E6%BB%9A%E5%8A%A8%E8%87%AA%E9%80%82%E5%BA%94%E6%87%92%E5%8A%A0%E8%BD%BD" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>07IntersectionObserver实现横竖滚动自适应懒加载</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2022/08%E5%89%8D%E7%AB%AF%E6%9E%84%E5%BB%BA%E7%9A%84%E5%AD%A6%E4%B9%A0(%E5%81%8F%E5%90%91vite)" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>08前端构建的学习(偏向vite)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2022/09Node%E6%A8%A1%E5%9D%97%E8%A7%84%E8%8C%83%E5%8F%8A%E6%A8%A1%E5%9D%97%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>09Node模块规范及模块加载机制</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2022/10Node%E5%BC%82%E6%AD%A5%E5%AE%9E%E7%8E%B0%E4%B8%8E%E4%BA%8B%E4%BB%B6%E9%A9%B1%E5%8A%A8" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>10Node异步实现与事件驱动</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2022/11Node%E5%86%85%E5%AD%98%E6%8E%A7%E5%88%B6" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>11Node内存控制</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2022/12Node%E8%BF%9B%E7%A8%8B%E5%8F%8A%E9%9B%86%E7%BE%A4%E7%9B%B8%E5%85%B3" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>12Node进程及集群相关</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2022/13CDN%E5%AE%9E%E8%B7%B5%E9%85%8D%E7%BD%AE+%E5%8E%9F%E7%90%86%E7%AF%87" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>13CDN实践配置+原理篇</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2022/14%E8%B6%85%E8%AF%A6%E7%BB%86%E7%9A%84%E5%89%8D%E7%AB%AF%E7%A8%8B%E5%BA%8F%E5%91%98git%E6%8C%87%E5%8C%97" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>14超详细的前端程序员git指北</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2022/15JavaScript%E5%9F%BA%E7%A1%80-replace%E6%96%B9%E6%B3%95%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E5%8F%82%E6%95%B0" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>15JavaScript基础-replace方法的第二个参数</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2022/16%E8%8E%B7%E5%8F%96Object%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%85%83%E7%B4%A0" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>16获取Object的第一个元素</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible has-active" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h3 class="text" data-v-6fca8b74>2023</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><section class="VPSidebarItem level-2 collapsible collapsed" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h4 class="text" data-v-6fca8b74>01</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/01/02JavaScript%E4%B8%93%E9%A2%98-%E5%8E%9F%E5%9E%8B%E9%93%BE" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>02JavaScript专题-原型链</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/01/08JavaScript%E4%B8%93%E9%A2%98-%E7%BB%A7%E6%89%BF" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>08JavaScript专题-继承</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/01/25%E6%B5%85%E8%B0%88NestJS%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>25浅谈NestJS设计思想</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/01/28%E4%BA%86%E8%A7%A3API%E7%9B%B8%E5%85%B3%E8%8C%83%E5%BC%8F(RPC%E3%80%81REST%E3%80%81GraphQL)" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>28了解API相关范式(RPC、REST、GraphQL)</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible collapsed has-active" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h4 class="text" data-v-6fca8b74>02</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/02/04Vue3%E7%9B%B8%E5%85%B3%E5%8E%9F%E7%90%86%E6%A2%B3%E7%90%86" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>04Vue3相关原理梳理</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/02/17%E8%81%8A%E8%81%8A%E6%BA%90%E7%AD%96%E7%95%A5%E9%99%90%E5%88%B6AJAX%E8%AF%B7%E6%B1%82" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>17聊聊源策略限制AJAX请求</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/02/19%E6%94%BE%E5%BC%83Cookie-Session%EF%BC%8C%E6%8B%A5%E6%8A%B1JWT%EF%BC%9F" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>19放弃Cookie-Session，拥抱JWT？</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/02/23%E4%BD%A0%E5%8F%AF%E8%83%BD%E5%BF%BD%E7%95%A5%E7%9A%8410%E7%A7%8DJavaScript%E5%BF%AB%E4%B9%90%E5%86%99%E6%B3%95" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>23你可能忽略的10种JavaScript快乐写法</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible collapsed" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h4 class="text" data-v-6fca8b74>03</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/03/06%E4%B8%89%E4%B8%AA%E7%BB%8F%E5%85%B8%E7%9A%84TypeScript%E6%98%93%E6%B7%B7%E6%B7%86%E7%82%B9" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>06三个经典的TypeScript易混淆点</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/03/22%E8%81%8A%E8%81%8A%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB(%E5%8E%86%E5%8F%B2%E3%80%81%E8%81%8C%E8%B4%A3%E5%88%92%E5%88%86%E3%80%81%E6%9C%AA%E6%9D%A5%E5%8F%91%E5%B1%95)" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>22聊聊前后端分离(历史、职责划分、未来发展)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/03/29%E5%89%8D%E7%AB%AF%E8%87%AA%E7%BB%99%E8%87%AA%E8%B6%B3UI%E8%AE%BE%E8%AE%A1%E7%A8%BF" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>29前端自给自足UI设计稿</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/03/31%E6%9E%81%E7%AE%80%E5%9C%B0%E7%BB%99%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0%E8%AE%A2%E9%98%85%E5%8A%9F%E8%83%BD" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>31极简地给个人博客添加订阅功能</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible collapsed" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h4 class="text" data-v-6fca8b74>04</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/04/05%E5%AE%9E%E7%8E%B0%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F(uniapp)%E4%B8%8A%E4%BC%A0%E5%A4%B4%E5%83%8F%E8%87%B3%E9%98%BF%E9%87%8C%E4%BA%91oss" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>05实现微信小程序(uniapp)上传头像至阿里云oss</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/04/17%E6%88%91%E7%BB%88%E4%BA%8E%E4%BC%9A%E7%94%A8Docker%E4%BA%86(nest+prisma+psotgresql+nginx+https)" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>17我终于会用Docker了(nest+prisma+psotgresql+nginx+https)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/04/20Vue3+TS(uniapp)%E6%89%8B%E6%92%B8%E4%B8%80%E4%B8%AA%E8%81%8A%E5%A4%A9%E9%A1%B5%E9%9D%A2" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>20Vue3+TS(uniapp)手撸一个聊天页面</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/04/23Nest%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%B8%A6%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%9A%84GraphQL%E8%AE%A2%E9%98%85Subscription" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>23Nest如何实现带身份验证的GraphQL订阅Subscription</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/04/26%E8%AF%95%E4%B8%8B%E5%BE%AE%E8%B0%83GPT-3%E5%81%9A%E4%B8%80%E4%B8%AA%E5%BF%83%E7%90%86%E9%97%AE%E7%AD%94%E6%9C%BA%E5%99%A8%E4%BA%BA" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>26试下微调GPT-3做一个心理问答机器人</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible collapsed" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h4 class="text" data-v-6fca8b74>05</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/05/01Nest%E7%9A%84test%E4%B8%AD%E7%9A%84best%E6%98%AFJest%E6%A1%86%E6%9E%B6" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>01Nest的test中的best是Jest框架</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/05/07%E4%B8%A4%E4%B8%AA%E5%A4%9A%E6%9C%88%E6%8D%A3%E9%BC%93%E4%BA%86%E4%B8%80%E4%B8%AA%E5%81%A5%E5%BA%B7%E7%B1%BB%E5%B0%8F%E7%A8%8B%E5%BA%8F" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>07两个多月捣鼓了一个健康类小程序</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/05/09PIXIJS%E5%BF%AB%E9%80%9F%E4%B8%80%E8%A7%88" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>09PIXIJS快速一览</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/05/11%E8%AF%A5%E7%BB%99%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%93%AA%E4%B8%80%E4%B8%AA%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6%E6%A8%A1%E5%9E%8B%E5%91%A2" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>11该给系统加哪一个权限控制模型呢</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible collapsed" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h4 class="text" data-v-6fca8b74>06</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/06/06%E7%AE%80%E5%8D%95%E4%BC%98%E5%8C%96%E4%B8%8B%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E9%A6%96%E9%A1%B5(%E8%BF%81%E7%A7%BBvitepress-beta%E7%89%88)" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>06简单优化下个人博客首页(迁移vitepress-beta版)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/06/18vitepress%E5%8D%9A%E5%AE%A2%E9%87%8C%E5%A2%9E%E5%8A%A0%E4%B8%80%E4%B8%AARSS%E8%AE%A2%E9%98%85" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>18vitepress博客里增加一个RSS订阅</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible collapsed" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h4 class="text" data-v-6fca8b74>07</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/07/02%E5%89%8D%E7%AB%AF%E5%8F%8Ctoken%E7%AD%96%E7%95%A5(uniapp-vue3-ts%E7%89%88)" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>02前端双token策略(uniapp-vue3-ts版)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/07/26(%E8%AF%91)%E9%9D%A2%E5%90%91JavaScript%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E7%9A%84Docker%E7%AE%80%E4%BB%8B%EF%BC%88Node.js%20%E5%92%8C%20PostgreSQL%EF%BC%89" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>26(译)面向JavaScript开发人员的Docker简介（Node.js 和 PostgreSQL）</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible collapsed" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h4 class="text" data-v-6fca8b74>08</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/08/17%E6%B5%85%E8%B0%88%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E5%8E%9F%E7%90%86" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>17浅谈搜索引擎原理</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/08/18%E7%BB%99vitepress%E5%A2%9E%E5%8A%A0%E7%9F%AD%E9%93%BE%E6%8E%A5%E7%94%9F%E6%88%90%E5%8A%9F%E8%83%BD" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>18给vitepress增加短链接生成功能</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/08/22Web%E6%9E%B6%E6%9E%84JAMStack%E2%80%9C%E4%BB%A5%E5%8A%A8%E5%88%B6%E9%9D%99%E2%80%9D" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>22Web架构JAMStack“以动制静”</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/08/29%E4%BD%A0%E6%9D%A5%E4%BD%A0%E4%B9%9F%E5%8F%AF%E4%BB%A5%E5%81%9A%E4%B8%80%E4%B8%AA%E7%BD%91%E7%9B%98%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>29你来你也可以做一个网盘搜索引擎</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/08/31%E5%8E%9F%E6%9D%A5Vue%E8%BF%98%E6%9C%89%E8%BF%99%E4%B9%88%E5%A4%9A%E5%A5%BD%E7%94%A8%E7%9A%84UI%E5%BA%93" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>31原来Vue还有这么多好用的UI库</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible collapsed" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h4 class="text" data-v-6fca8b74>09</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/09/28vitepress%E4%B8%AD%E5%A2%9E%E5%8A%A0twitter%E5%8D%A1%E7%89%87" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>28vitepress中增加twitter卡片</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/09/29vitepress%E4%B8%AD%E5%BC%95%E5%85%A5Tdesign%E5%B9%B6%E5%85%A8%E5%B1%80%E5%A2%9E%E5%8A%A0%E5%A4%A7%E5%9B%BE%E9%A2%84%E8%A7%88" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>29vitepress中引入Tdesign并全局增加大图预览</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/09/29%E8%87%AA%E6%89%98%E7%AE%A1%E9%A1%B9%E7%9B%AE%E5%B7%A5%E5%85%B7plane%E7%AE%A1%E7%90%86%E8%87%AA%E5%B7%B1%E7%9A%84TodoList" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>29自托管项目工具plane管理自己的TodoList</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible collapsed" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h4 class="text" data-v-6fca8b74>11</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/11/01%E6%90%9E%E4%B8%AA%E5%9F%9F%E5%90%8D%E9%82%AE%E7%AE%B1%E7%8E%A9%E7%8E%A9%EF%BC%88%E5%A6%82just@justin3go.com%EF%BC%89" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>01搞个域名邮箱玩玩（如just@justin3go.com）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/11/08%E7%9C%8B%E7%9C%8Bopenai%E5%8F%91%E5%B8%83%E4%BC%9A" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>08看看openai发布会</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/11/14%E5%9C%A8uniapp%E4%B8%AD%E4%BD%BF%E7%94%A8GraphQL%E7%9A%84%E4%B8%80%E4%BA%9B%E6%8E%A2%E7%B4%A2" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>14在uniapp中使用GraphQL的一些探索</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/11/29%E6%B8%B8%E6%A0%87%E5%88%86%E9%A1%B5%E8%BE%83%E4%BC%A0%E7%BB%9F%E5%88%86%E9%A1%B5%E7%9A%84%E4%BC%98%E5%8A%BF%E4%BB%A5%E5%8F%8A%E8%AF%A6%E7%BB%86%E5%AE%9E%E7%8E%B0" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>29游标分页较传统分页的优势以及详细实现</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible collapsed" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h4 class="text" data-v-6fca8b74>12</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2023/12/11%E8%82%A1%E7%A5%A8%E5%9F%BA%E9%87%91%E5%B8%B8%E7%94%A8%E6%8C%87%E6%A0%87%E3%80%81%E6%96%B9%E6%B3%95%E8%A7%A3%E9%87%8A" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>11股票基金常用指标、方法解释</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h3 class="text" data-v-6fca8b74>2024</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><section class="VPSidebarItem level-2 collapsible collapsed" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h4 class="text" data-v-6fca8b74>01</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2024/01/03%E5%A4%A9%E5%86%B7%E4%BA%86%EF%BC%8C%E7%AC%94%E8%AE%B0%E6%9C%AC%E4%B9%9F%E9%9C%80%E8%A6%81%E4%BF%9D%E6%9A%96%E4%BA%86" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>03天冷了，笔记本也需要保暖了</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2024/01/12%E5%86%99%E4%B8%AAdocker+nginx%E9%83%A8https%E7%9A%84%E6%A8%A1%E6%9D%BF" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>12写个docker+nginx部https的模板</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2024/01/26Nuxt3%E6%89%8B%E5%86%99%E4%B8%80%E4%B8%AA%E6%90%9C%E7%B4%A2%E9%A1%B5%E9%9D%A2" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>26Nuxt3手写一个搜索页面</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible collapsed" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h4 class="text" data-v-6fca8b74>02</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2024/02/18%E5%8F%88%E4%B8%80%E6%AC%A1%E5%BC%80%E5%A7%8B%E5%AD%A6%E8%8B%B1%E8%AF%AD%E4%BA%86%EF%BC%8C%E5%B8%8C%E6%9C%9B%E8%BF%99%E6%AC%A1%E8%83%BD%E4%BA%AB%E5%8F%97%E5%AE%83" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>18又一次开始学英语了，希望这次能享受它</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible collapsed" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h4 class="text" data-v-6fca8b74>04</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2024/04/18%E6%9C%80%E8%BF%91GPT%E5%B8%AE%E6%88%91%E8%A7%A3%E5%86%B3%E7%9A%8430%E4%B8%AA%E9%97%AE%E9%A2%98" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>18最近GPT帮我解决的30个问题</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E5%8D%9A%E5%AE%A2/2024/04/28%E5%A6%82%E4%BD%95%E8%AE%A8%E5%A5%BD%E8%AF%BB%E8%80%85%E6%88%96%E8%A7%82%E4%BC%97" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>28如何讨好读者或观众</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-8bd2d7b5><section class="VPSidebarItem level-0 collapsible" data-v-8bd2d7b5 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h2 class="text" data-v-6fca8b74>笔记</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><section class="VPSidebarItem level-1 collapsible" data-v-6fca8b74 data-v-6fca8b74><div class="item" role="button" tabindex="0" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><h3 class="text" data-v-6fca8b74>houduan</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6fca8b74><span class="vpi-chevron-right caret-icon" data-v-6fca8b74></span></div></div><div class="items" data-v-6fca8b74><!--[--><div class="VPSidebarItem level-2 is-link" data-v-6fca8b74 data-v-6fca8b74><div class="item" data-v-6fca8b74><div class="indicator" data-v-6fca8b74></div><a class="VPLink link link" href="/%E7%AC%94%E8%AE%B0/houduan/01Django" data-v-6fca8b74><!--[--><p class="text" data-v-6fca8b74>Django进阶学习笔记</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-db8121a0 data-v-aacfb0ea><div class="VPDoc has-sidebar has-aside" data-v-aacfb0ea data-v-2a7707a5><!--[--><!--]--><div class="container" data-v-2a7707a5><div class="aside" data-v-2a7707a5><div class="aside-curtain" data-v-2a7707a5></div><div class="aside-container" data-v-2a7707a5><div class="aside-content" data-v-2a7707a5><div class="VPDocAside" data-v-2a7707a5 data-v-904f9579><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-904f9579 data-v-79457ae9><div class="content" data-v-79457ae9><div class="outline-marker" data-v-79457ae9></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-79457ae9>大纲</div><ul class="VPDocOutlineItem root" data-v-79457ae9 data-v-a77102d5><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-904f9579></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-2a7707a5><div class="content-container" data-v-2a7707a5><!--[--><!--]--><main class="main" data-v-2a7707a5><div style="position:relative;" class="vp-doc _%E5%8D%9A%E5%AE%A2_2023_02_04Vue3%E7%9B%B8%E5%85%B3%E5%8E%9F%E7%90%86%E6%A2%B3%E7%90%86" data-v-2a7707a5><div><h1 id="一文梳理vue3核心原理" tabindex="-1">一文梳理Vue3核心原理 <a class="header-anchor" href="#一文梳理vue3核心原理" aria-label="Permalink to &quot;一文梳理Vue3核心原理&quot;">​</a></h1><!----><h2 id="前言" tabindex="-1">前言 <a class="header-anchor" href="#前言" aria-label="Permalink to &quot;前言&quot;">​</a></h2><p>==<strong>⚠万字长文warn</strong>==本篇文章更多是以梳理的视角进行讲述，将各个原理细节串在一起，方便查漏补缺，而非为了讲懂某个原理，当然也会大致讲解。所以如果某个原理不太清楚，请自行查阅其他文章，我也会尽量给出相关的阅读推荐。</p><p>==本文阅读需要你有一定的vue应用程序开发经验并了解一些原理==</p><blockquote><p>接下来先废话一下，关注知识点的可以直接跳过前言部分</p></blockquote><p>首先，我们先回到最初的起点是<strong>为什么要使用Vue框架</strong>，它为我们做了什么工作：</p><ol><li>能开发出一个应用？</li><li>性能好、构建产物轻量？</li><li>对用户友好，声明式代码心智负担小？</li><li>可组件化开发？</li><li>社区活跃，生态丰富？</li><li>...</li></ol><p>无论是官网介绍的优点，还是网友们提出的优点...首先这些都是毋庸置疑的，这也是一个成熟框架必备的一些属性。</p><p>好，我们来说但是：对于一个框架使用者，我们当然希望功能越丰富越好，但是对于一个框架初期学习者，我们则需要的是关注核心链路</p><blockquote><p>就比如<a href="https://cn.vuejs.org/guide/built-ins/keep-alive.html" target="_blank" rel="noreferrer"><code>&lt;KeepAlive&gt;</code>组件</a>原理我们前期有必要学习吗？除非你目前遇到过这样的问题，否则不建议有限的时间先学它。和玩游戏的道理一样，先做主线任务，再根据时间安排接取一些世界任务...</p></blockquote><p>这也是笔者写本文的原因，在这里我理解最主要的就是要扮演好<a href="https://juejin.cn/post/6844903929298288647#heading-0" target="_blank" rel="noreferrer">MVVM</a>中的ViewModel角色：</p><p>ViewModel层通过<strong>双向数据绑定</strong>将View层和Model层连接了起来，使得View层和Model层的同步工作完全是自动的</p><p>这也可能为什么这是官网介绍的<a href="https://cn.vuejs.org/guide/introduction.html#what-is-vue" target="_blank" rel="noreferrer">第一个例子</a>：</p><p><img src="https://oss.justin3go.com/blogs/Pasted%20image%2020230128230710.png" alt="" loading="lazy"></p><p>接下来就进入正题，看看框架在背后做了哪些工作👊，并且笔者会在文末给出几个扩展问题供大家思考...</p><h2 id="概括" tabindex="-1">概括 <a class="header-anchor" href="#概括" aria-label="Permalink to &quot;概括&quot;">​</a></h2><p>把框架理解为一个封装好的函数，所以首先需要确认函数的输入以及函数的返回。在这里，用户（开发者）的输入就是单文件组件，输出就是带有一些优秀特性的可运行的代码、用户预期的结果，比如上述这个<code>count</code>例子的结果展示。</p><blockquote><p>源码分支较多，细节丰富。如下图很难大而全地概括整个运行过程，仅供参考，也欢迎在评论区友善提出你的想法。</p></blockquote><p><img src="https://oss.justin3go.com/blogs/Vue%E5%8E%9F%E7%90%86%E6%A2%B3%E7%90%86.png" alt="" loading="lazy"></p><p>首先我们有一个按照Vue格式写的一个文件，该文件会经过如下步骤成为最终在浏览器上运行显示的文件：</p><ol start="0"><li>将源文件通过编译手段转换为一个组件对象，其中render函数的返回值是该组件对应的虚拟DOM</li><li>将组件对象交给渲染模块进行初始化</li><li>使用<code>ReactiveEffect()</code>函数对该组件对象的渲染任务进行包装，即依赖收集。</li><li>通过VNode渲染出对应的HTML挂载到页面上</li><li>用户操作页面中的响应式数据后，触发更新</li><li>响应式模块根据响应式数据找到其依赖的副作用函数并执行以更新页面、响应用户。</li></ol><h2 id="编译器" tabindex="-1">编译器 <a class="header-anchor" href="#编译器" aria-label="Permalink to &quot;编译器&quot;">​</a></h2><p>编译原理是一门复杂的学科，当时做这门课的课设时也是心态炸裂，难忘的经历。这里一两句，甚至一两篇文章都很难讲明白。但不是很影响接下来的内容，如果你对编译原理有一定的了解当然最好，没有的话你只需要理解如下非常简单的内容：</p><ul><li>假设源内容为<code>I am Justin3go</code></li><li>经过编译器内部结构识别我们识别到了<code>(I =&gt; 主语) (am =&gt; 谓语) (Justin3go =&gt; 宾语)</code></li><li>假设我设计的编译器功能就是主谓互换，所以结果就是<code>Justin3go am I</code>（这里忽略英语语法的问题）</li><li>再简单来说就是做字符串处理，根据原有结构进行文本替换增删以实现目标功能</li></ul><p><em>PS：编译原理对于前端来说也是一门非常重要的课程，有时间就看看书研究一下吧，这也是我后续的学习计划。</em></p><p>而回到这里无非就是识别HTML中的特殊语法、字符（如：<code>v-model</code>、双花括号等）进行转换或者打上标记等等</p><p>==还是那句话，编译原理部分这里不进行叙述，接下来主要对针对Vue框架特有的编译优化进行了解，一些思想还是非常值得学习的==</p><p><strong>推荐链接</strong>：</p><ul><li>你可以在官网的这个位置：<a href="https://cn.vuejs.org/guide/extras/rendering-mechanism.html#compiler-informed-virtual-dom" target="_blank" rel="noreferrer">参考链接</a>找到对应的讲解</li><li>你可以在<a href="https://template-explorer.vuejs.org/" target="_blank" rel="noreferrer">模板编译预览器</a>中自行快速实践，值得注意的是：你可以在右上角Options菜单中开启相关的优化选项以验证想法</li></ul><h3 id="block树与动态结点收集" tabindex="-1">Block树与动态结点收集 <a class="header-anchor" href="#block树与动态结点收集" aria-label="Permalink to &quot;Block树与动态结点收集&quot;">​</a></h3><p><strong>1）为什么会有Block树的出现</strong>：</p><p>我们知道HTML模板在render函数中是以树状结构表示的。随着项目的复杂度增加，这个树的复杂度也随之增加，遍历并比较新旧的难度也增加。如果我们把其中某些子树分别看作整体，即作为结点，那么这颗树的复杂度会大大降低，如下图：</p><p><img src="https://oss.justin3go.com/blogs/Block%E6%A0%91.png" alt="" loading="lazy"></p><p><strong>2）为什么可以把某些子树看作整体Block</strong>：</p><p>因为这些Block不需要再进行遍历，因为编译器在初始化过程中会将其中的动态结点（会被更新的结点）进行了以Block为单位进行了收集，将这些动态结点以数组的形式存储在了Block上，就是算法中经典的空间换时间思想。故后续不需要遍历Block的内部结构了，因为有个扁平的数组结构存储了更新需要的必要信息。</p><p><strong>3）Block是如何进行划分的</strong>：</p><ul><li>模板的根作为一个Block，每个Block会收集内部除了子Block包含的结点之外的所有动态结点</li><li><code>v-if</code>、<code>v-for</code>等可能改变结点结构的指令对应的标签作为一个block</li></ul><p>值得一说的是，假设不将这些结构指令作为一个block的话：</p><ul><li><code>v-if</code>有可能让结点结构从整个树上消失，所以我们此时就不能作出安全的假设，比如条件为真时，<code>v-if</code>内部的动态结点应该被收集到上层Block的数组中；但条件为假时，就不应该被收集，所以框架将其作为一个Block就可以很好的解决这个问题：将该结构指令内的动态结点收集到该Block中，这个动态结点的信息就能随着结构的切换而出现或消失了</li><li><code>v-for</code>指令同样如此，因为我们可能无法预先知道其会渲染多少个结点</li></ul><h3 id="静态结点优化" tabindex="-1">静态结点优化 <a class="header-anchor" href="#静态结点优化" aria-label="Permalink to &quot;静态结点优化&quot;">​</a></h3><p>静态结点：在后续更新时永远不会改变的结点，比如一个文本结点</p><p>而静态优化（<a href="https://vue-next-template-explorer.netlify.app/#eyJzcmMiOiI8ZGl2PlxuICA8ZGl2PmZvbzwvZGl2PlxuICA8ZGl2PmJhcjwvZGl2PlxuICA8ZGl2Pnt7IGR5bmFtaWMgfX08L2Rpdj5cbjwvZGl2PiIsInNzciI6ZmFsc2UsIm9wdGlvbnMiOnsiaG9pc3RTdGF0aWMiOnRydWV9fQ==" target="_blank" rel="noreferrer">静态提升</a>）就是将这些静态结点保存到渲染函数之外，渲染函数仅引用这些静态结点，这样做的<strong>优点</strong>就是：</p><ul><li>避免重新创建对象，然后扔掉造成的性能损失，毕竟是静态结点不会变化</li><li>在更新页面时，渲染器可以直接跳过新旧VNode这部分的比较</li></ul><blockquote><p>此外，当有足够多连续的静态元素时，它们还会再被压缩为一个“静态 vnode”，其中包含的是这些节点相应的纯 HTML 字符串。(<a href="https://vue-next-template-explorer.netlify.app/#eyJzcmMiOiI8ZGl2PlxuICA8ZGl2IGNsYXNzPVwiZm9vXCI+Zm9vPC9kaXY+XG4gIDxkaXYgY2xhc3M9XCJmb29cIj5mb288L2Rpdj5cbiAgPGRpdiBjbGFzcz1cImZvb1wiPmZvbzwvZGl2PlxuICA8ZGl2IGNsYXNzPVwiZm9vXCI+Zm9vPC9kaXY+XG4gIDxkaXYgY2xhc3M9XCJmb29cIj5mb288L2Rpdj5cbiAgPGRpdj57eyBkeW5hbWljIH19PC9kaXY+XG48L2Rpdj4iLCJzc3IiOmZhbHNlLCJvcHRpb25zIjp7ImhvaXN0U3RhdGljIjp0cnVlfX0=" target="_blank" rel="noreferrer">示例</a>)。这些静态节点会直接通过 <code>innerHTML</code> 来挂载。同时还会在初次挂载后缓存相应的 DOM 节点。如果这部分内容在应用中其他地方被重用，那么将会使用原生的 <code>cloneNode()</code> 方法来克隆新的 DOM 节点，这会非常高效。</p></blockquote><h3 id="内联事件优化" tabindex="-1">内联事件优化 <a class="header-anchor" href="#内联事件优化" aria-label="Permalink to &quot;内联事件优化&quot;">​</a></h3><p>假设我们有如下模板代码：</p><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="复制代码" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> @click</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;onClick&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;hello&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在不进行事件缓存优化的情况下，会被编译成如下渲染函数：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="复制代码" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { createElementVNode </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _createElementVNode, openBlock </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _openBlock, createElementBlock </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _createElementBlock } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;vue&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_cache</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$props</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_openBlock</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_createElementBlock</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;div&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    _createElementVNode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;div&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      id: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      onClick: _ctx.onClick</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> /* PROPS */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;onClick&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>上述<code>render</code>函数在进行更新时，<code>{ id: &quot;foo&quot;,onClick: _ctx.onClick}</code>必须作为一个整体进行diff，不管有多少东西在这<code>div</code>上，比如有非常多的子结点等等。</p><p>所以即使从模板中我们可以看到这个ID实际上是静态的，永远不会改变，我们还是会遍历整个对象，只是为了确保它不会改变，因为运行时没有足够的信息来知道这方面。</p><p>而开启事件缓存优化之后，如下：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="复制代码" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { createElementVNode </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _createElementVNode, openBlock </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _openBlock, createElementBlock </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _createElementBlock } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;vue&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_cache</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$props</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_openBlock</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_createElementBlock</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;div&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    _createElementVNode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;div&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      id: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      onClick: _cache[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (_cache[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (_ctx.onClick </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onClick</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">args)))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>非常简单的代码，就是如果有缓存，读取缓存上的事件，如果对应位置没有缓存，则重新从上下文中获取该事件。</p><p>这样做的<strong>优点</strong>是：此时该组件对象中的所有事件都是“不变的”，都是一个指针，变化的是指向的对象，这样无论事件对应的值如何变化，该组件对象都不会因为事件变化而更新了</p><h3 id="vue3编译优化总结" tabindex="-1">vue3编译优化总结 <a class="header-anchor" href="#vue3编译优化总结" aria-label="Permalink to &quot;vue3编译优化总结&quot;">​</a></h3><table tabindex="0"><thead><tr><th>优化手段</th><th>简介</th><th>优点</th></tr></thead><tbody><tr><td>Block树与动态结点收集</td><td>将根结点、结构指令结点作为Block，以Block为单位进行动态结点收集</td><td>简化HTML树结构，降低遍历难度、对比难度</td></tr><tr><td>静态提升</td><td>将静态结点的信息提升在render函数之外</td><td>不会重复渲染静态结点信息，提高性能</td></tr><tr><td>内联事件优化</td><td>render函数存储的是事件的指针，对应事件会被缓存在一个数组中</td><td>组件对象不会应该经常变化的事件而频繁更新了</td></tr></tbody></table><h2 id="渲染模块" tabindex="-1">渲染模块 <a class="header-anchor" href="#渲染模块" aria-label="Permalink to &quot;渲染模块&quot;">​</a></h2><blockquote><p>每个组件实例的render函数会返回该组件的虚拟DOM</p></blockquote><p>渲染器的作用简单来说就是让虚拟DOM变为真实DOM</p><p><img src="https://oss.justin3go.com/blogs/%E6%B8%B2%E6%9F%93%E5%99%A8%E8%BF%87%E7%A8%8B.png" alt="" loading="lazy"></p><h3 id="虚拟dom概念" tabindex="-1">虚拟DOM概念 <a class="header-anchor" href="#虚拟dom概念" aria-label="Permalink to &quot;虚拟DOM概念&quot;">​</a></h3><p>搜索和更新数千个DOM节点很明显会变慢，这就是Vue和其他类似框架的作用----<a href="https://cn.vuejs.org/guide/extras/rendering-mechanism.html#virtual-dom" target="_blank" rel="noreferrer">Virtual DOM</a></p><p>Virual Node是一个JavaScript对象，Vue知道如何使用这些Virtual Node并挂载待DOM上，它会更新我们在浏览器上看到的内容，<strong>每个VNode对应一个DOM节点</strong>，Vue通过寻找更新VNode最小的更新数量，然后再将最优策略施加到实际DOM中，从而减少DOM操作，提高性能</p><p>就好比在更新时对比施工图纸，找到最优的更新策略，而非把整栋楼拆了重建，或者是去楼的内部一一对比哪些不同，哪些需要更新这样耗时耗力。</p><blockquote><p>除了初始化过程中Vue框架会把<code>HTML</code>模板编译为VNode，用户也可以直接使用<a href="https://cn.vuejs.org/guide/extras/render-function.html#creating-vnodes" target="_blank" rel="noreferrer">h函数</a>用于创建VNode</p></blockquote><p>优点：</p><ul><li>它让组件的渲染逻辑完全从真实DOM中解耦</li><li>更直接地去重用框架的运行在其他环境中，Vue运行第三方开发人员创建自定义渲染解决方案，目标不仅仅是浏览器，也包括IOS和Android等原生环境，也可以使用API创建自定义渲染器直接渲染到WebGL,而不是DOM节点</li><li>提供了以编程方式构造、检查、克隆以及操作所需的DOM操作的能力</li></ul><h3 id="patch函数" tabindex="-1">Patch函数 <a class="header-anchor" href="#patch函数" aria-label="Permalink to &quot;Patch函数&quot;">​</a></h3><p>Patch函数中使用了非常多的分支结构来应对不同的情况，比如对经过编译优化打上标记的结点可以进行快速更新，而更新时也有不同的元素类型，属性，结构等都有不同的分支结构调用不同的API进行处理。</p><p>篇幅和精力有限，这里不可能也没必要进行完整的介绍，我理解这部分只需要认识<code>Patch()</code>函数是干嘛的就OK了，固仅对其比较经典的Diff算法进行详细介绍</p><blockquote><p><a href="https://github.com/vuejs/core/blob/main/packages/runtime-core/src/renderer.ts#L357" target="_blank" rel="noreferrer">源码位置</a>，有兴趣或者想求证的可以瞧瞧....</p></blockquote><p>如下是一个经过简化（不考虑编译信息，减少类型分支）的<code>patch()</code>函数，参考自<a href="https://www.vuemastery.com/courses/vue3-deep-dive-with-evan-you/creating-a-patch-function" target="_blank" rel="noreferrer">creating-a-patch-function</a></p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="复制代码" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;app&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">// n1是旧的虚拟DOM，之前的快照，n2是新的虚拟DOM，是我们现在想要展示在界面的部分</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">// patch需要找出最小数量它需要执行的DOM操作</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">function patch(n1, n2){</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 这里仅讨论相同类型需要做的工作</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n1.tag </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n2.tag){</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 中间这部是为了在以后的更新中成为未来的快照</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        const el </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n2.el </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n1.el</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // props </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 这里不讨论n1,n2的props是否为空的四种分支情况</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        const oldProps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n1.props </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        const newProps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n2.props </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">const</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> key</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> in</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> newProps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">){</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> oldValue</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldProps[key]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> newValue</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newProps[key]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // 只有在实际变化后才会调用，以最小化实际DOM API的调用</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(newValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldValue){</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // 旧的没有，set会添加，旧的有key，set会替换</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                el.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setAttribute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(key, newValue)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 接下来讨论key不在newProps中的时候</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">const</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> key</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> in</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> oldProps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">){</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldProps)){</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                el.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">removeAttribute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(key)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // children</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        const oldChildren</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n1.children</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        const newChildren </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n2.children</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">typeof</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> newChildren</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> === </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;string&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">){</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldChildren </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;string&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">){</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(newChildren </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldChildren){</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                    el.textContent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newChildren</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // 使用文本直接覆盖现有的DOM节点并丢弃它们</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                el.textContent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newChildren</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }else{  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// newC是arr的情况</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldChildren </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;string&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">){</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                el.innreHTML </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 清理，然后这个元素变为空元素</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // 加入</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                newChildren,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">child</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                    mount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(child, el)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 都是数组的情况</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">				// 略...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }else{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // other case</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">// 演示</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">function mount(vnode, container){</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	// 略</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">const vdom = h(&#39;div&#39;, {class: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;red&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    h(&#39;span&#39;, null, [&#39;hello&#39;])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mount(vdom, document.getElementById(&quot;app&quot;))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">const vdom2 = h(&#39;div&#39;, {class: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;green&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    h(&#39;span&#39;, null, [&#39;changed&#39;])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">patch(vdom, vdom2)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br></div></div><h3 id="diff算法" tabindex="-1">Diff算法 <a class="header-anchor" href="#diff算法" aria-label="Permalink to &quot;Diff算法&quot;">​</a></h3><p>当我们遇到新旧节点都包含子节点的时候，即两个数组需要对比，又没有其他快捷更新的信息时，就不得不进行<code>full diff</code>，关于该部分Vue通过<a href="https://github.com/vuejs/core/blob/main/packages/runtime-core/src/renderer.ts#L1751" target="_blank" rel="noreferrer"><code>patchKeyedChildren()</code>函数</a>进行了实现。</p><p><em>注：接下来的算法讲解例子将脱离框架运行环境，抽象为纯粹的<strong>新旧两个数组进行同步，找出最少的更新步骤</strong>的一个算法问题。</em></p><p>顺便再提一下：之所以需要找到最优的更新策略，是因为实际DOM操作远比JS的数组比较耗时，这就是虚拟DOM作为实际DOM的设计图纸优势之一。</p><h4 id="key的作用" tabindex="-1">Key的作用 <a class="header-anchor" href="#key的作用" aria-label="Permalink to &quot;Key的作用&quot;">​</a></h4><p>框架通过判断结点的key值和结点类型，从而确认新旧结点是否是可以复用的结点--&quot;结点是否相同&quot;。</p><p>值得注意的是：DOM可复用并不意味着不需要更新，比如文本结点的文本不同，只是意味着我们可以直接在同一结点上进行patch操作，而不需要移动、增、删结点。</p><blockquote><p>可以参考<a href="https://github.com/vuejs/core/blob/main/packages/runtime-core/src/vnode.ts#L367" target="_blank" rel="noreferrer">这部分代码实现</a></p></blockquote><h4 id="_1-4预处理" tabindex="-1">1-4预处理 <a class="header-anchor" href="#_1-4预处理" aria-label="Permalink to &quot;1-4预处理&quot;">​</a></h4><p>基本思想非常简单，<strong>就是在正式处理之前，先处理头尾相同的部分</strong>，这部分结点是相同的，可以直接进行patch操作，不需要移动结点顺序。</p><p>如下两个新旧数组需要进行同步，假设数字相同认为结点相同：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="复制代码" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> oldNodes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> newNodes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>相信这个问题对大家应该问题不大，这里笔者贴合源码步骤简单实现一下供大家参考：</p><ol><li>sync from start：同步更新开始部分结点相同的</li><li>sync from end：同步更新结束部分结点相同的</li><li>common sequence + mount：无剩余未处理旧结点，但剩有新的结点，执行挂载操作</li><li>common sequence + unmount：有剩余未处理旧结点，无剩余未处理新结点，执行卸载操作</li></ol><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="复制代码" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {number[]}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldNodes</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {number[]}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newNodes</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> preProcess</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">oldNodes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">newNodes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">){</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // * 初始化</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 两个数组遍历开始的索引</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> newLen</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newNodes.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 由于两个数组开始位置都由i控制，但两数组可能长度不同，故这里用两个指针控制两数组的结束位置</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldEndPos </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldNodes.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newEndPos </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newNodes.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldEndPos </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newEndPos) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> oldNode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldNodes[i];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> newNode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newNodes[i];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(oldNode </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newNode) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`start部分执行patch(oldNode, newNode)`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> break</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`从前往后首次两个结点不相同的坐标为：${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldEndPos </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newEndPos) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> oldNode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldNodes[oldEndPos];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> newNode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newNodes[newEndPos];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(oldNode </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newNode) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`end部分执行patch(oldNode, newNode)`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> break</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        oldEndPos</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        newEndPos</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`从后往前首次两个结点不相同的坐标为 old：${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">oldEndPos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}; new：${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">newEndPos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 执行完上述操作，可能出现两种特殊情况，就是有可能新旧数组可能某一方被处理完了（无剩余结点）</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 此时就可以执行全部挂载和全部卸载的操作。简单来说就是有一方不是数组了，不需要再对两个数组进行对比了。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldEndPos) {  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 旧结点数组被处理完了</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newEndPos) {  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 新结点数组还有剩余</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // 执行挂载操作，新的设计图纸表明要增加，所以这里这里要在施工场地做增加操作</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`将${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">newNodes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">slice</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">newEndPos</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}挂载到真实环境中`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newEndPos) {  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 新结点数组被处理完了，else表示旧结点还有剩余</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`将${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">oldNodes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">slice</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">oldEndPos</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}从真实环境中卸载`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`剩下的新旧节点数组都不为空[unknown sequence]`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 源码是在这里进行乱序序列处理的，不过这里为了方便分步运行演示，就抛出坐标给后续函数处理</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [i, oldEndPos, newEndPos];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><p>预处理代码非常简单，不过能在该情景想到这样的处理却是非常巧妙，下方为上方函数的运行效果，大家也可以复制上方代码自行尝试：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="复制代码" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`预处理结果为${</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">preProcess</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">], [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">])</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`预处理结果为${</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">preProcess</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">], [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">])</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://oss.justin3go.com/blogs/Pasted%20image%2020230202233312.png" alt="" loading="lazy"></p><h4 id="_5-处理乱序序列" tabindex="-1">5. 处理乱序序列 <a class="header-anchor" href="#_5-处理乱序序列" aria-label="Permalink to &quot;5. 处理乱序序列&quot;">​</a></h4><p>到了这里，我们继续明确我们需要解决的问题，脱离API，抽象为一个算法问题就是：两个乱序新旧数组，如何尽可能多的复用旧数组的结点完成到新数组的更新</p><p><em>注：回到浏览器环境中是依据新旧数组的最优更新策略操作真实的DOM数组</em></p><p>同样这里为了简化问题，以数字代表虚拟结点，<strong>并假设数字相同认为结点相同（即key也相同）</strong>，比如假设下方数据为预处理之后的数据：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="复制代码" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> oldNodes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">14</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">17</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> newNodes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">14</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 其中11,12,13,14,15,16这类结点可以直接通过移动完成更新</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 而17在新数组未出现，故需要在真实DOM数组中卸载该结点</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 18在旧数组未出现，故需创建该结点并挂载到真实DOM数组中</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这步相对于预处理来说比较复杂，但是再复杂的问题拆解为每一小步之后就更加容易理解了，源码部分也有关键的注释将<a href="https://github.com/vuejs/core/blob/main/packages/runtime-core/src/renderer.ts#L1864" target="_blank" rel="noreferrer">这步</a>分为了3小步</p><h5 id="确定新结点位置-5-1-5-2" tabindex="-1">确定新结点位置（5.1+5.2） <a class="header-anchor" href="#确定新结点位置-5-1-5-2" aria-label="Permalink to &quot;确定新结点位置（5.1+5.2）&quot;">​</a></h5><p><strong>1）做什么</strong></p><p>还是经典的思路，先确定这步要做什么：构造一个新数组各结点位置在旧数组中各结点位置的一个对应关系<code>newIndexToOldIndexMap</code>。</p><p><em>构造这个结构是为了后续方便求最长递增子序列，具体原因在那小节详细介绍。</em></p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="复制代码" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// old对应位置索引为[(11=&gt;0),(12=&gt;1),(13=&gt;2),(14=&gt;3),(15=&gt;4),(16=&gt;5),(17=&gt;6)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> oldNodes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">14</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">17</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>然后通过判断结点key是否相同，这里假设的是数字是否相同，从而确定新结点数组在旧结点数组中的位置索引：</p><p><img src="https://oss.justin3go.com/blogs/%E7%A1%AE%E5%AE%9A%E6%96%B0%E8%99%9A%E6%8B%9F%E7%BB%93%E7%82%B9%E6%95%B0%E7%BB%84%E4%BD%8D%E7%BD%AE.png" alt="" loading="lazy"></p><p>该例子中的<code>newIndexToOldIndexMap = [3, 0, 1, 5, 2, 4, -1]</code></p><p>明白了需要做什么，接下来这步算法的实现相对来说也不难</p><p><strong>2）降低算法复杂度</strong></p><p>值得注意的是：同样这里也是通过遍历这两个数组来填充<code>newIndexToOldIndexMap</code>，即暴力解法的算法复杂度为: $$O(n^2)$$ 所以为了优化这里利用了<strong>空间换时间</strong>思想。使用<code>keyToNewIndexMap</code>先存储了新节点数组的关键信息：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="复制代码" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 伪代码表示结果如下</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> keyToNewIndexMap</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">14</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>之后在遍历旧结点数组时，就可以在<code>O(1)</code>的复杂度通过旧结点的key直接获取新结点的位置，而非每次都在内部嵌套循环遍历新结点数组去重新获取对应新节点位置，最终构造<code>newIndexToOldIndexMap</code>的算法复杂度降到了 $$O(n)$$</p><p><strong>3）代码实现</strong></p><blockquote><p><code>pos</code>变量表示：在旧 children 中寻找具有相同 key 值节点的过程中，遇到的最大索引值。如果在后续寻找的过程中，存在索引值比当前遇到的最大索引值还要小的节点，则意味着该节点需要移动<code>moved=true</code></p></blockquote><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="复制代码" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {number[]}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldNodes</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {number[]}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newNodes</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {number}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 上部分传递过来的i</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {number}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newEndPos</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {number}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldEndPos</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> buildMap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">oldNodes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">newNodes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">j</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">newEndPos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">oldEndPos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> oldStartPos</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> newStartPos</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 构造keyToNewIndexMap索引表</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> keyToNewIndexMap</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newStartPos; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newEndPos; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        keyToNewIndexMap[newNodes[i]] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 构造 newIndexToOldIndexMap 数组</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> count</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newEndPos </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> newIndexToOldIndexMap</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(count).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fill</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> moved </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pos </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 记录寻找过程中遇到的最大索引值</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> patched </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 表示更新过的节点数量</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldStartPos; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldEndPos; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> oldNode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldNodes[i]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 如果更新过的节点数量小于等于需要更新的节点数量，则执行更新</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (patched </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> count) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> k</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> keyToNewIndexMap[oldNode]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 通过旧结点的key找到新结点的位置</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;undefined&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> newNode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newNodes[k]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`i=${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">},执行patch(${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">oldNode</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}, ${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">newNode</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">})`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // 每更新一个节点，都将 patched +1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                patched</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                newIndexToOldIndexMap[k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newStartPos] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 填充</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pos) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                    moved </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                    pos </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`i=${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}，没找到:unmount(${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">oldNode</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">})`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // 如果更新过的节点数量大于需要更新的节点数量，则卸载多余的节点</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`i=${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}，卸载多余的节点:unmount(${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">oldNode</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">})`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [moved, newIndexToOldIndexMap];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><p>运行代码演示如下：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="复制代码" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">buildMap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">14</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">17</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">14</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="https://oss.justin3go.com/blogs/Pasted%20image%2020230203195703.png" alt="" loading="lazy"></p><h5 id="最长递增子序列完成最优更新-5-3" tabindex="-1">最长递增子序列完成最优更新（5.3） <a class="header-anchor" href="#最长递增子序列完成最优更新-5-3" aria-label="Permalink to &quot;最长递增子序列完成最优更新（5.3）&quot;">​</a></h5><p>这里解释一下为什么需要<code>newIndexToOldIndexMap</code>，该结构记录的时新数组各结点位置在旧数组中各结点位置的一个对应关系。这个结构中数组下标对应旧结点，数组值对应新结点。如<code>[3,0,1,5,2,4,-1]</code>中<code>(0=&gt;3),(1=&gt;0),(2=&gt;1),(3=&gt;5),(4=&gt;2),(5=&gt;4)</code></p><p>最长递增子序列：就是名字的意思，递增子序列中最长的那一个</p><p>而我们的总目标就是要找到最少的移动次数，而旧数组的位置索引在<code>newIndexToOldIndexMap</code>是递增的顺序，所以我们只需要找到新结点数组的最长的递增的结点们，就能找到最优的移动策略，然后进行移动就可以了，如图：</p><p><img src="https://oss.justin3go.com/blogs/%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97%E7%A7%BB%E5%8A%A8%E7%AD%96%E7%95%A5.png" alt="" loading="lazy"></p><p>上图新节点的最长递增子序列的<code>[1,2,4]</code>，即图中白色节点不需要移动，所以该移动策略的移动次数为3次。</p><p>推荐链接：</p><ul><li><a href="https://github.com/vuejs/core/blob/bef85e7975084b05af00b60ecd171c83f251c6d5/packages/runtime-core/src/renderer.ts#L2403" target="_blank" rel="noreferrer">源代码链接</a>，这是纯粹的算法实现，这里笔者就不重复实现了...</li><li><a href="https://leetcode.cn/problems/longest-increasing-subsequence/" target="_blank" rel="noreferrer">算法题链接</a>，力扣上也是一个常规的中等题，大家也可以练练手...</li></ul><p>最后就是进行结点的移动了，这部分代码也没什么特别的逻辑【略】</p><h3 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h3><ul><li>虚拟DOM：解耦真实环境，提高更新性能，提高各平台兼容性</li><li>Patch函数：更新节点时使用</li><li>Diff算法：预处理+空间换时间+最长递增子序列</li></ul><h2 id="响应式" tabindex="-1">响应式 <a class="header-anchor" href="#响应式" aria-label="Permalink to &quot;响应式&quot;">​</a></h2><p>响应式这块就我而言是看到网上文章出现频率最多的一个模块了，它就是状态数据与视图双向绑定的具体实现了。</p><p>==具体代码细节笔者这里不过多赘述了，有点肝不动了，主要走走响应式系统的运行过程==</p><h3 id="响应式概念" tabindex="-1">响应式概念 <a class="header-anchor" href="#响应式概念" aria-label="Permalink to &quot;响应式概念&quot;">​</a></h3><p>假设我们有一个<a href="https://github.com/vuejs/core/blob/main/packages/vue/examples/composition/todomvc.html" target="_blank" rel="noreferrer">todoList应用</a>，其中的所有事项我们设置为响应式数据，当用户增删改事项时，我们作为开发者只需修改对应数据就可以了，至于后续页面事项列表的重新渲染是通过响应式模块自动触发的，这也是我们为什么要使用框架的原因之一。</p><p><img src="https://oss.justin3go.com/blogs/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9B%B4%E6%96%B0%E8%BF%87%E7%A8%8B.png" alt="" loading="lazy"></p><p>接下来我们就来打开这个黑盒瞧瞧...</p><h3 id="主要工作流程" tabindex="-1">主要工作流程 <a class="header-anchor" href="#主要工作流程" aria-label="Permalink to &quot;主要工作流程&quot;">​</a></h3><p><strong>1）响应式简单理解就两步：<code>track</code> + <code>trigger</code>，中文含义为跟踪+触发:</strong></p><ol><li>跟踪(track)：就是我们常说的依赖收集，对于响应式数据，找到依赖于该数据的<a href="https://baike.baidu.com/item/%E5%87%BD%E6%95%B0%E5%89%AF%E4%BD%9C%E7%94%A8/22723425" target="_blank" rel="noreferrer">副作用函数</a>，然后使用一个方便的存储结构存储对应关系</li><li>触发(trigger)：当我们监听到响应式数据变化时，就在之前收集的存储桶里面找到相关联的<a href="https://baike.baidu.com/item/%E5%87%BD%E6%95%B0%E5%89%AF%E4%BD%9C%E7%94%A8/22723425" target="_blank" rel="noreferrer">副作用函数</a>，然后执行就可以了</li></ol><p><strong>2）为了自动触发，使用了<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy" target="_blank" rel="noreferrer">Proxy</a>代理响应式对象<code>ReactiveObject</code>:</strong></p><ol><li>将track函数放入了<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/get" target="_blank" rel="noreferrer">get</a>，即使用该数据时会自动触发<code>track()</code></li><li>将trigger函数放入了<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/set" target="_blank" rel="noreferrer">set</a>，即修改该数据时会自动触发<code>trigger()</code></li></ol><p><strong>3）为了避免硬编码函数名，即每次在track时都必须知道副作用函数的名字</strong></p><ul><li>我们使用了全局变量<code>activeEffect</code>来代替，即track函数每次收集<code>activeEffect</code>指向的函数即可</li><li>然后通过<code>ReactiveEffect</code>注册传递过来的副作用函数，将该<code>activeEffect</code>变量指向该副作用函数</li></ul><p>下面就介绍一下<strong>稍微具体一点的工作链路</strong>，如果你有一定的源码阅读经验或者学习过响应式原理，下方结合代码的图对你来说应该轻而易举，如果没有，也不用慌张，接下来会一步步介绍其工作流程。</p><p><img src="https://oss.justin3go.com/blogs/Pasted%20image%2020230204034327.png" alt="" loading="lazy"></p><blockquote><p><a href="https://juejin.cn/post/7145756356014768158" target="_blank" rel="noreferrer">参考图片原文</a></p></blockquote><p><strong>工作过程：</strong></p><ol start="0"><li>首先我们有一个响应式数据<code>ReactiveObject{}</code>和依赖于该数据的一个副作用函数<code>Effect()</code></li><li>将我们副作用函数传递到<code>ReactiveEffect</code>函数中</li><li>注册该副作用函数，将<code>activeEffect</code>变量指向它</li><li>执行该副作用函数</li><li>由于该副作用函数依赖于我们的响应式数据<code>ReactiveObject</code>，并且我们已经为<code>ReactiveObject</code>设置了代理拦截操作<code>get</code>，故在读取该值时会自动触发track函数</li><li>track函数找到<code>activeEffect</code>变量，此时指向的正是我们需要的Effect函数</li><li>将属性值与副作用函数绑定关系并存储</li><li><code>activeEffect = null</code>方便后续使用</li></ol><p>当我们更新了响应式数据中的值后，由于我们已经为<code>ReactiveObject</code>设置了代理拦截操作<code>set</code>，故会在我们设置该对象属性值时自动触发trigger函数</p><ol start="8"><li>找到属性值依赖的副作用函数</li><li>执行该副作用函数完成自动更新</li></ol><p>核心代码实现对应图片如下：</p><p><img src="https://oss.justin3go.com/blogs/Pasted%20image%2020230204050757.png" alt="" loading="lazy"></p><blockquote><p><a href="https://juejin.cn/post/7145756356014768158" target="_blank" rel="noreferrer">参考图片原文</a></p></blockquote><h3 id="结合渲染模块" tabindex="-1">结合渲染模块 <a class="header-anchor" href="#结合渲染模块" aria-label="Permalink to &quot;结合渲染模块&quot;">​</a></h3><p>响应式模块的更新流程相信大家已经不陌生了，无非就是更改响应式数据后，被代理中的<code>set</code>等拦截，然后执行数据属性相关联的副作用函数从而完成响应式更新。</p><p>接下来主要结合渲染模块谈谈框架是如何让一个组件进入响应式模块的，简单来说就是<strong>初始化过程是如何工作的</strong>：</p><p><em>准备，首先是响应式数据已经建立，即框架已经对该数据建立了代理，并设置了各种拦截器。此时如果我们读取或者操作该响应式数据，就会自动触发相关函数</em></p><p><img src="https://oss.justin3go.com/blogs/%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BB%93%E5%90%88%E6%B8%B2%E6%9F%93%E6%A8%A1%E5%9D%97%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B.png" alt="" loading="lazy"></p><ul><li>总的来说就是在初始化组件是会调用渲染模块</li><li>然后就会调用一些（上下文+渲染模块中的函数）作为后续组件的更新函数，即副作用函数。</li><li>然后传递给响应式模块进行依赖收集，看看与哪些响应式数据有关，从而建立依赖关系。</li></ul><h3 id="深入源码" tabindex="-1">深入源码 <a class="header-anchor" href="#深入源码" aria-label="Permalink to &quot;深入源码&quot;">​</a></h3><p>篇幅有限，这部分就不详细介绍了，如下为主要函数的源码位置索引：</p><ul><li><a href="https://github.com/vuejs/core/blob/main/packages/reactivity/src/baseHandlers.ts#L94" target="_blank" rel="noreferrer">createGetter</a></li><li><a href="https://github.com/vuejs/core/blob/main/packages/reactivity/src/baseHandlers.ts#L161" target="_blank" rel="noreferrer">createSetter</a></li><li><a href="https://github.com/vuejs/core/blob/main/packages/reactivity/src/effect.ts#L213" target="_blank" rel="noreferrer">track</a></li><li><a href="https://github.com/vuejs/core/blob/main/packages/reactivity/src/effect.ts#L263" target="_blank" rel="noreferrer">trigger</a></li></ul><h3 id="其他" tabindex="-1">其他 <a class="header-anchor" href="#其他" aria-label="Permalink to &quot;其他&quot;">​</a></h3><p>关于响应式模块，除了上述主要工作流程，还有一些其他经典问题，这里进行一个基本汇总（该部分相关链接仅作参考，笔者仅粗略阅读符合问题描述即可）：</p><table tabindex="0"><thead><tr><th>问题标题</th><th>简述</th><th>深入阅读链接</th></tr></thead><tbody><tr><td>effectStack</td><td>effect函数内部嵌套effect函数时，activeEffect变量会被覆盖消失，故添加一个栈进行保存</td><td><a href="https://juejin.cn/post/7100778134240231437" target="_blank" rel="noreferrer">阅读链接</a></td></tr><tr><td>computed</td><td>effect.lazy选项 + getter实现，可缓存，需要时执行副作用函数，而非响应式数据一变化就直接执行</td><td><a href="https://juejin.cn/post/7085524315063451684" target="_blank" rel="noreferrer">阅读链接</a></td></tr><tr><td>watch</td><td>effect.scheduler选项控制执行时机+保存旧值</td><td><a href="https://juejin.cn/post/7087748001208205343" target="_blank" rel="noreferrer">阅读链接</a></td></tr><tr><td>更全面的监测机制</td><td>使用proxy各种拦截器处理一些边界条件，比如拦截<code>.length</code>、<code>in</code>...等</td><td><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/ownKeys" target="_blank" rel="noreferrer">阅读链接</a></td></tr><tr><td>ref</td><td>简单理解为reactive的<code>.value</code>属性</td><td><a href="https://vuejsdevelopers.com/2022/06/01/ref-vs-reactive/" target="_blank" rel="noreferrer">阅读链接</a></td></tr></tbody></table><h2 id="扩展问题" tabindex="-1">扩展问题 <a class="header-anchor" href="#扩展问题" aria-label="Permalink to &quot;扩展问题&quot;">​</a></h2><h3 id="_1-为什么vue3的模板根结点可以为多结点" tabindex="-1">1. 为什么Vue3的模板根结点可以为多结点 <a class="header-anchor" href="#_1-为什么vue3的模板根结点可以为多结点" aria-label="Permalink to &quot;1. 为什么Vue3的模板根结点可以为多结点&quot;">​</a></h3><ul><li>Vue2在组件中只有一个根节点。</li><li>Vue3在组件可以拥有多个根节点。</li></ul><p>在渲染函数层面支持<code>Fragment</code>，其本身不会渲染任何内容，可以理解为在多个根节点外包裹一层<code>Fragment</code>就可以处理了。</p><p><a href="https://github.com/vuejs/core/blob/main/packages/runtime-core/src/renderer.ts#L400" target="_blank" rel="noreferrer"><code>processFragment()</code></a></p><p>==欢迎补充...==</p><h2 id="最后" tabindex="-1">最后 <a class="header-anchor" href="#最后" aria-label="Permalink to &quot;最后&quot;">​</a></h2><p>一直都想写一篇文章将所学的Vue原理部分串起来，难度确实较大，自己也一拖再拖。如何做到详略得当，如何深入浅出等等。在梳理脉络、书写文章方面自己还有很多地方值得加强。</p><ul><li>最后在这里欢迎补充；</li><li>精力有限，长文难免有误，如果错误，也希望你能友善指出🤝；</li><li>码字不易，如果本文对你有所帮助，还望不吝👍。</li></ul><p><img src="https://oss.justin3go.com/blogs/Pasted%20image%2020230203012605.png" alt="" loading="lazy"></p><h2 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-label="Permalink to &quot;参考&quot;">​</a></h2><ul><li><a href="https://cn.vuejs.org/guide/extras/ways-of-using-vue.html" target="_blank" rel="noreferrer">Vue官网-进阶主题</a></li><li><a href="https://juejin.cn/post/7145756356014768158" target="_blank" rel="noreferrer">从原理和源码理解Vue3的响应式机制</a></li><li><a href="https://juejin.cn/post/6858899262596448270" target="_blank" rel="noreferrer">vue3.0 响应式原理(超详细)</a></li><li><a href="https://www.ituring.com.cn/book/2953" target="_blank" rel="noreferrer">VueJS设计与实现</a></li><li><a href="https://www.vuemastery.com/courses/vue3-deep-dive-with-evan-you/vue3-overview" target="_blank" rel="noreferrer">Vue 3 Deep Dive with Evan You</a></li><li><a href="https://juejin.cn/post/7115014433109180423" target="_blank" rel="noreferrer">Vue 文件是如何被转换并渲染到页面的？</a></li><li><a href="https://juejin.cn/post/7190726242042118200" target="_blank" rel="noreferrer">Vue 3.2 源码系列：04-有点难的《最新 diff 算法详解》</a></li><li><a href="https://juejin.cn/post/6995732683435278344" target="_blank" rel="noreferrer">细说 Vue.js 3.2 关于响应式部分的优化</a></li></ul></div></div></main><footer class="VPDocFooter" data-v-2a7707a5 data-v-d89806b0><!--[--><!--[--><!--[--><!--[--><!--[--><div class="weiz-public" data-v-931ade2c><div class="copyright" data-v-931ade2c><div class="copyright__author" data-v-931ade2c><span class="copyright-meta" data-v-931ade2c><i class="weiz-icon weiz-icon-user main" data-v-931ade2c></i>文章作者: </span><span class="copyright-info" data-v-931ade2c><a href="" data-v-931ade2c>xiaohuayu</a></span></div><div class="copyright__type" data-v-931ade2c><span class="copyright-meta" data-v-931ade2c><i class="weiz-icon weiz-icon-link main" data-v-931ade2c></i>文章链接: </span><span class="copyright-info" data-v-931ade2c><a href="" data-v-931ade2c></a></span></div><div class="copyright__notice" data-v-931ade2c><span class="copyright-meta" data-v-931ade2c><i class="weiz-icon weiz-icon-cc main" data-v-931ade2c></i>版权声明: </span><span class="copyright-info" data-v-931ade2c> 本站文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" data-v-931ade2c>BY-NC-SA 4.0</a> 许可协议， 转载请注明来自 <a href="" data-v-931ade2c></a>！ </span></div><i class="copyright-symbol weiz-icon weiz-icon-public main" data-v-931ade2c></i></div></div><div class="post-tags" data-v-931ade2c><div class="tags-list" data-v-931ade2c><!--[--><!--]--></div></div><!--]--><!--]--><!--]--><!--]--><!--]--><div class="edit-info" data-v-d89806b0><div class="edit-link" data-v-d89806b0><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/Justin3go/justin3go.github.io/edit/master/docs/博客/2023/02/04Vue3相关原理梳理.md" target="_blank" rel="noreferrer" data-v-d89806b0><!--[--><span class="vpi-square-pen edit-link-icon" data-v-d89806b0></span> 在GitHub上编辑此页<!--]--></a></div><div class="last-updated" data-v-d89806b0><p class="VPLastUpdated" data-v-d89806b0 data-v-cfd2bab0>最近更新时间: <time datetime="2025-10-11T15:22:18.000Z" data-v-cfd2bab0></time></p></div></div><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-db8121a0 data-v-833156e9><div class="container" data-v-833156e9><p class="message" data-v-833156e9><a href="https://github.com/Justin3go/justin3go.github.io" target="_blank">网站已开源，每周末如有更新release一次，欢迎star</a></p><p class="copyright" data-v-833156e9><a href="https://beian.miit.gov.cn/#/Integrated/index" target="_blank">Copyright© 2021-present 渝ICP备2021006879号</a></p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"ai中文_01java迷宫.md\":\"By6Ghd9k\",\"ai中文_ai-local-painting.md\":\"BqAuuzUs\",\"features_index.md\":\"DiRxxRcZ\",\"features_test.md\":\"D4oLJd7g\",\"index.md\":\"DidVda1W\",\"pages_posts.md\":\"PvhMdAnG\",\"pages_tags.md\":\"SVmCSDAm\",\"博客_2020_01java迷宫.md\":\"CtKaE13U\",\"博客_2020_02使用anaconda中的prompt配置虚拟环境的常用命令.md\":\"DFB1F5lv\",\"博客_2020_index.md\":\"Dnmt6-Lk\",\"博客_2021_01scrapy爬虫详解.md\":\"B_qDRfcq\",\"博客_2021_02tfidf计算的学习.md\":\"CXDWQQAX\",\"博客_2021_03操作系统内存分配模拟程序.md\":\"CWqmurFU\",\"博客_2021_04散列表实现查找.md\":\"D89t_1Gi\",\"博客_2021_index.md\":\"Dp4wTvvN\",\"博客_2022_01都2022年了，还是得学圣杯布局与双飞翼布局.md\":\"DjOHHBk-\",\"博客_2022_02typescript入门.md\":\"Ce_GNS3g\",\"博客_2022_03这道题原来可以用到js这么多知识点！.md\":\"SFl54tTP\",\"博客_2022_04git常用操作.md\":\"EKzMGQ7n\",\"博客_2022_05前端程序员搭建自己的codeide（code-server教程）.md\":\"BXcfWCbi\",\"博客_2022_06玩转vitepress.md\":\"varMZT_T\",\"博客_2022_07intersectionobserver实现横竖滚动自适应懒加载.md\":\"CNxFyMAs\",\"博客_2022_08前端构建的学习(偏向vite).md\":\"DPtP0F_d\",\"博客_2022_09node模块规范及模块加载机制.md\":\"072htv0r\",\"博客_2022_10node异步实现与事件驱动.md\":\"C49gseqW\",\"博客_2022_11node内存控制.md\":\"BIs2Ww9d\",\"博客_2022_12node进程及集群相关.md\":\"Pw1_lOp4\",\"博客_2022_13cdn实践配置_原理篇.md\":\"Dk73VW7n\",\"博客_2022_14超详细的前端程序员git指北.md\":\"CYvCpwIY\",\"博客_2022_15javascript基础-replace方法的第二个参数.md\":\"DM_K9-zg\",\"博客_2022_16获取object的第一个元素.md\":\"CgfB5CGY\",\"博客_2022_index.md\":\"D2wcKdFv\",\"博客_2023_01_02javascript专题-原型链.md\":\"CbKG8hSn\",\"博客_2023_01_08javascript专题-继承.md\":\"B5jU7g3I\",\"博客_2023_01_25浅谈nestjs设计思想.md\":\"Blv_31aK\",\"博客_2023_01_28了解api相关范式(rpc、rest、graphql).md\":\"DhP43SdE\",\"博客_2023_02_04vue3相关原理梳理.md\":\"DYqRfGO6\",\"博客_2023_02_17聊聊源策略限制ajax请求.md\":\"BOigo8GX\",\"博客_2023_02_19放弃cookie-session，拥抱jwt？.md\":\"CanKuKhx\",\"博客_2023_02_23你可能忽略的10种javascript快乐写法.md\":\"6lcerxW9\",\"博客_2023_03_06三个经典的typescript易混淆点.md\":\"BlQxs0ZR\",\"博客_2023_03_22聊聊前后端分离(历史、职责划分、未来发展).md\":\"DEaM5MgN\",\"博客_2023_03_29前端自给自足ui设计稿.md\":\"UQ3h_sf0\",\"博客_2023_03_31极简地给个人博客添加订阅功能.md\":\"D1FIYMob\",\"博客_2023_04_05实现微信小程序(uniapp)上传头像至阿里云oss.md\":\"DGr8ptnm\",\"博客_2023_04_17我终于会用docker了(nest_prisma_psotgresql_nginx_https).md\":\"CrnU-EHD\",\"博客_2023_04_20vue3_ts(uniapp)手撸一个聊天页面.md\":\"NKgchQM8\",\"博客_2023_04_23nest如何实现带身份验证的graphql订阅subscription.md\":\"PQWIpULY\",\"博客_2023_04_26试下微调gpt-3做一个心理问答机器人.md\":\"DRtatJPc\",\"博客_2023_05_01nest的test中的best是jest框架.md\":\"CkpIt4Uy\",\"博客_2023_05_07两个多月捣鼓了一个健康类小程序.md\":\"CiW83za8\",\"博客_2023_05_09pixijs快速一览.md\":\"CNlnBLjB\",\"博客_2023_05_11该给系统加哪一个权限控制模型呢.md\":\"B1Sczbmc\",\"博客_2023_06_06简单优化下个人博客首页(迁移vitepress-beta版).md\":\"BH5gMykA\",\"博客_2023_06_18vitepress博客里增加一个rss订阅.md\":\"y4VzaWjE\",\"博客_2023_07_02前端双token策略(uniapp-vue3-ts版).md\":\"BMU5-xl5\",\"博客_2023_07_26(译)面向javascript开发人员的docker简介（node.js 和 postgresql）.md\":\"WjEdN_jP\",\"博客_2023_08_17浅谈搜索引擎原理.md\":\"BzKmgt1t\",\"博客_2023_08_18给vitepress增加短链接生成功能.md\":\"OrRM9RN_\",\"博客_2023_08_22web架构jamstack“以动制静”.md\":\"D7aOIzcg\",\"博客_2023_08_29你来你也可以做一个网盘搜索引擎.md\":\"B6hLLLhA\",\"博客_2023_08_31原来vue还有这么多好用的ui库.md\":\"BShDOHeq\",\"博客_2023_09_28vitepress中增加twitter卡片.md\":\"DG13Xv7i\",\"博客_2023_09_29vitepress中引入tdesign并全局增加大图预览.md\":\"BudbDBZL\",\"博客_2023_09_29自托管项目工具plane管理自己的todolist.md\":\"BoUIN6Sf\",\"博客_2023_11_01搞个域名邮箱玩玩（如just@justin3go.com）.md\":\"DrwiHOwu\",\"博客_2023_11_08看看openai发布会.md\":\"-Kz9lVyX\",\"博客_2023_11_14在uniapp中使用graphql的一些探索.md\":\"DPm2a0dg\",\"博客_2023_11_29游标分页较传统分页的优势以及详细实现.md\":\"BrXhSt60\",\"博客_2023_12_11股票基金常用指标、方法解释.md\":\"CuyqYFhM\",\"博客_2024_01_03天冷了，笔记本也需要保暖了.md\":\"YDGSAYxW\",\"博客_2024_01_12写个docker_nginx部https的模板.md\":\"p4NL26LT\",\"博客_2024_01_26nuxt3手写一个搜索页面.md\":\"CfmPfR59\",\"博客_2024_02_18又一次开始学英语了，希望这次能享受它.md\":\"BWsC5Kxs\",\"博客_2024_04_18最近gpt帮我解决的30个问题.md\":\"CcH9t1UG\",\"博客_2024_04_28如何讨好读者或观众.md\":\"Bjgs7jfi\",\"博客_index.md\":\"CLNF8tBv\",\"笔记_houduan_01django.md\":\"YPVe9Ola\",\"笔记_houduan_index.md\":\"JgmTmROV\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CH\",\"dir\":\"ltr\",\"title\":\"Justin3go's Blog-🖊\",\"titleTemplate\":\":title-Justin3go's Blog-🖊\",\"description\":\"坚持深耕技术领域的T型前端程序员, 喜欢Vuejs、Nestjs, 还会点python、nlp、web3、后端\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":[2,4],\"outlineTitle\":\"大纲\",\"lastUpdatedText\":\"最近更新时间\",\"nav\":[{\"text\":\"首页\",\"link\":\"/\"},{\"text\":\"博客\",\"link\":\"/博客/\",\"activeMatch\":\"/博客/\"},{\"text\":\"笔记\",\"link\":\"/笔记/\",\"activeMatch\":\"/笔记/\"},{\"text\":\"标签\",\"link\":\"/pages/tags\",\"activeMatch\":\"/pages/tags\"},{\"text\":\"归档\",\"link\":\"/pages/posts\",\"activeMatch\":\"/pages/posts\"},{\"text\":\"线上\",\"activeMatch\":\"/线上/\",\"items\":[{\"text\":\"自建项目\",\"items\":[{\"text\":\"笑友小程序\",\"link\":\"https://oss.justin3go.com/blogs/xiaoyou-mp-code.png\"},{\"text\":\"阿里云盘搜索\",\"link\":\"https://ssgo.app\"},{\"text\":\"Use Sora\",\"link\":\"https://usesora.app\"},{\"text\":\"Excel2JSON\",\"link\":\"https://bug404.dev\"}]},{\"text\":\"开源部署\",\"items\":[{\"text\":\"ChatGPT-Web\",\"link\":\"https://chat.justin3go.com/\"},{\"text\":\"LobeChat\",\"link\":\"https://chatc.app\"}]}]}],\"sidebar\":[{\"text\":\"post\",\"items\":[{\"text\":\"ai中文\",\"items\":[{\"text\":\"Java迷宫\",\"link\":\"/post/ai中文/01Java迷宫\"},{\"text\":\"AI 作画本地搭建\",\"link\":\"/post/ai中文/ai-local-painting\"}],\"collapsed\":false}],\"collapsed\":false},{\"text\":\"博客\",\"items\":[{\"text\":\"2020\",\"items\":[{\"text\":\"01Java迷宫\",\"link\":\"/博客/2020/01Java迷宫\"},{\"text\":\"02使用anaconda中的Prompt配置虚拟环境的常用命令\",\"link\":\"/博客/2020/02使用anaconda中的Prompt配置虚拟环境的常用命令\"}],\"collapsed\":false},{\"text\":\"2021\",\"items\":[{\"text\":\"01scrapy爬虫详解\",\"link\":\"/博客/2021/01scrapy爬虫详解\"},{\"text\":\"02TFIDF计算的学习\",\"link\":\"/博客/2021/02TFIDF计算的学习\"},{\"text\":\"03操作系统内存分配模拟程序\",\"link\":\"/博客/2021/03操作系统内存分配模拟程序\"},{\"text\":\"04散列表实现查找\",\"link\":\"/博客/2021/04散列表实现查找\"}],\"collapsed\":false},{\"text\":\"2022\",\"items\":[{\"text\":\"01都2022年了，还是得学圣杯布局与双飞翼布局\",\"link\":\"/博客/2022/01都2022年了，还是得学圣杯布局与双飞翼布局\"},{\"text\":\"02TypeScript入门\",\"link\":\"/博客/2022/02TypeScript入门\"},{\"text\":\"03这道题原来可以用到JS这么多知识点！\",\"link\":\"/博客/2022/03这道题原来可以用到JS这么多知识点！\"},{\"text\":\"04git常用操作\",\"link\":\"/博客/2022/04git常用操作\"},{\"text\":\"05前端程序员搭建自己的CodeIDE（code-server教程）\",\"link\":\"/博客/2022/05前端程序员搭建自己的CodeIDE（code-server教程）\"},{\"text\":\"06玩转vitepress\",\"link\":\"/博客/2022/06玩转vitepress\"},{\"text\":\"07IntersectionObserver实现横竖滚动自适应懒加载\",\"link\":\"/博客/2022/07IntersectionObserver实现横竖滚动自适应懒加载\"},{\"text\":\"08前端构建的学习(偏向vite)\",\"link\":\"/博客/2022/08前端构建的学习(偏向vite)\"},{\"text\":\"09Node模块规范及模块加载机制\",\"link\":\"/博客/2022/09Node模块规范及模块加载机制\"},{\"text\":\"10Node异步实现与事件驱动\",\"link\":\"/博客/2022/10Node异步实现与事件驱动\"},{\"text\":\"11Node内存控制\",\"link\":\"/博客/2022/11Node内存控制\"},{\"text\":\"12Node进程及集群相关\",\"link\":\"/博客/2022/12Node进程及集群相关\"},{\"text\":\"13CDN实践配置+原理篇\",\"link\":\"/博客/2022/13CDN实践配置+原理篇\"},{\"text\":\"14超详细的前端程序员git指北\",\"link\":\"/博客/2022/14超详细的前端程序员git指北\"},{\"text\":\"15JavaScript基础-replace方法的第二个参数\",\"link\":\"/博客/2022/15JavaScript基础-replace方法的第二个参数\"},{\"text\":\"16获取Object的第一个元素\",\"link\":\"/博客/2022/16获取Object的第一个元素\"}],\"collapsed\":false},{\"text\":\"2023\",\"items\":[{\"text\":\"01\",\"items\":[{\"text\":\"02JavaScript专题-原型链\",\"link\":\"/博客/2023/01/02JavaScript专题-原型链\"},{\"text\":\"08JavaScript专题-继承\",\"link\":\"/博客/2023/01/08JavaScript专题-继承\"},{\"text\":\"25浅谈NestJS设计思想\",\"link\":\"/博客/2023/01/25浅谈NestJS设计思想\"},{\"text\":\"28了解API相关范式(RPC、REST、GraphQL)\",\"link\":\"/博客/2023/01/28了解API相关范式(RPC、REST、GraphQL)\"}],\"collapsed\":true},{\"text\":\"02\",\"items\":[{\"text\":\"04Vue3相关原理梳理\",\"link\":\"/博客/2023/02/04Vue3相关原理梳理\"},{\"text\":\"17聊聊源策略限制AJAX请求\",\"link\":\"/博客/2023/02/17聊聊源策略限制AJAX请求\"},{\"text\":\"19放弃Cookie-Session，拥抱JWT？\",\"link\":\"/博客/2023/02/19放弃Cookie-Session，拥抱JWT？\"},{\"text\":\"23你可能忽略的10种JavaScript快乐写法\",\"link\":\"/博客/2023/02/23你可能忽略的10种JavaScript快乐写法\"}],\"collapsed\":true},{\"text\":\"03\",\"items\":[{\"text\":\"06三个经典的TypeScript易混淆点\",\"link\":\"/博客/2023/03/06三个经典的TypeScript易混淆点\"},{\"text\":\"22聊聊前后端分离(历史、职责划分、未来发展)\",\"link\":\"/博客/2023/03/22聊聊前后端分离(历史、职责划分、未来发展)\"},{\"text\":\"29前端自给自足UI设计稿\",\"link\":\"/博客/2023/03/29前端自给自足UI设计稿\"},{\"text\":\"31极简地给个人博客添加订阅功能\",\"link\":\"/博客/2023/03/31极简地给个人博客添加订阅功能\"}],\"collapsed\":true},{\"text\":\"04\",\"items\":[{\"text\":\"05实现微信小程序(uniapp)上传头像至阿里云oss\",\"link\":\"/博客/2023/04/05实现微信小程序(uniapp)上传头像至阿里云oss\"},{\"text\":\"17我终于会用Docker了(nest+prisma+psotgresql+nginx+https)\",\"link\":\"/博客/2023/04/17我终于会用Docker了(nest+prisma+psotgresql+nginx+https)\"},{\"text\":\"20Vue3+TS(uniapp)手撸一个聊天页面\",\"link\":\"/博客/2023/04/20Vue3+TS(uniapp)手撸一个聊天页面\"},{\"text\":\"23Nest如何实现带身份验证的GraphQL订阅Subscription\",\"link\":\"/博客/2023/04/23Nest如何实现带身份验证的GraphQL订阅Subscription\"},{\"text\":\"26试下微调GPT-3做一个心理问答机器人\",\"link\":\"/博客/2023/04/26试下微调GPT-3做一个心理问答机器人\"}],\"collapsed\":true},{\"text\":\"05\",\"items\":[{\"text\":\"01Nest的test中的best是Jest框架\",\"link\":\"/博客/2023/05/01Nest的test中的best是Jest框架\"},{\"text\":\"07两个多月捣鼓了一个健康类小程序\",\"link\":\"/博客/2023/05/07两个多月捣鼓了一个健康类小程序\"},{\"text\":\"09PIXIJS快速一览\",\"link\":\"/博客/2023/05/09PIXIJS快速一览\"},{\"text\":\"11该给系统加哪一个权限控制模型呢\",\"link\":\"/博客/2023/05/11该给系统加哪一个权限控制模型呢\"}],\"collapsed\":true},{\"text\":\"06\",\"items\":[{\"text\":\"06简单优化下个人博客首页(迁移vitepress-beta版)\",\"link\":\"/博客/2023/06/06简单优化下个人博客首页(迁移vitepress-beta版)\"},{\"text\":\"18vitepress博客里增加一个RSS订阅\",\"link\":\"/博客/2023/06/18vitepress博客里增加一个RSS订阅\"}],\"collapsed\":true},{\"text\":\"07\",\"items\":[{\"text\":\"02前端双token策略(uniapp-vue3-ts版)\",\"link\":\"/博客/2023/07/02前端双token策略(uniapp-vue3-ts版)\"},{\"text\":\"26(译)面向JavaScript开发人员的Docker简介（Node.js 和 PostgreSQL）\",\"link\":\"/博客/2023/07/26(译)面向JavaScript开发人员的Docker简介（Node.js 和 PostgreSQL）\"}],\"collapsed\":true},{\"text\":\"08\",\"items\":[{\"text\":\"17浅谈搜索引擎原理\",\"link\":\"/博客/2023/08/17浅谈搜索引擎原理\"},{\"text\":\"18给vitepress增加短链接生成功能\",\"link\":\"/博客/2023/08/18给vitepress增加短链接生成功能\"},{\"text\":\"22Web架构JAMStack“以动制静”\",\"link\":\"/博客/2023/08/22Web架构JAMStack“以动制静”\"},{\"text\":\"29你来你也可以做一个网盘搜索引擎\",\"link\":\"/博客/2023/08/29你来你也可以做一个网盘搜索引擎\"},{\"text\":\"31原来Vue还有这么多好用的UI库\",\"link\":\"/博客/2023/08/31原来Vue还有这么多好用的UI库\"}],\"collapsed\":true},{\"text\":\"09\",\"items\":[{\"text\":\"28vitepress中增加twitter卡片\",\"link\":\"/博客/2023/09/28vitepress中增加twitter卡片\"},{\"text\":\"29vitepress中引入Tdesign并全局增加大图预览\",\"link\":\"/博客/2023/09/29vitepress中引入Tdesign并全局增加大图预览\"},{\"text\":\"29自托管项目工具plane管理自己的TodoList\",\"link\":\"/博客/2023/09/29自托管项目工具plane管理自己的TodoList\"}],\"collapsed\":true},{\"text\":\"11\",\"items\":[{\"text\":\"01搞个域名邮箱玩玩（如just@justin3go.com）\",\"link\":\"/博客/2023/11/01搞个域名邮箱玩玩（如just@justin3go.com）\"},{\"text\":\"08看看openai发布会\",\"link\":\"/博客/2023/11/08看看openai发布会\"},{\"text\":\"14在uniapp中使用GraphQL的一些探索\",\"link\":\"/博客/2023/11/14在uniapp中使用GraphQL的一些探索\"},{\"text\":\"29游标分页较传统分页的优势以及详细实现\",\"link\":\"/博客/2023/11/29游标分页较传统分页的优势以及详细实现\"}],\"collapsed\":true},{\"text\":\"12\",\"items\":[{\"text\":\"11股票基金常用指标、方法解释\",\"link\":\"/博客/2023/12/11股票基金常用指标、方法解释\"}],\"collapsed\":true}],\"collapsed\":false},{\"text\":\"2024\",\"items\":[{\"text\":\"01\",\"items\":[{\"text\":\"03天冷了，笔记本也需要保暖了\",\"link\":\"/博客/2024/01/03天冷了，笔记本也需要保暖了\"},{\"text\":\"12写个docker+nginx部https的模板\",\"link\":\"/博客/2024/01/12写个docker+nginx部https的模板\"},{\"text\":\"26Nuxt3手写一个搜索页面\",\"link\":\"/博客/2024/01/26Nuxt3手写一个搜索页面\"}],\"collapsed\":true},{\"text\":\"02\",\"items\":[{\"text\":\"18又一次开始学英语了，希望这次能享受它\",\"link\":\"/博客/2024/02/18又一次开始学英语了，希望这次能享受它\"}],\"collapsed\":true},{\"text\":\"04\",\"items\":[{\"text\":\"18最近GPT帮我解决的30个问题\",\"link\":\"/博客/2024/04/18最近GPT帮我解决的30个问题\"},{\"text\":\"28如何讨好读者或观众\",\"link\":\"/博客/2024/04/28如何讨好读者或观众\"}],\"collapsed\":true}],\"collapsed\":false}],\"collapsed\":false},{\"text\":\"笔记\",\"items\":[{\"text\":\"houduan\",\"items\":[{\"text\":\"Django进阶学习笔记\",\"link\":\"/笔记/houduan/01Django\"}],\"collapsed\":false}],\"collapsed\":false}],\"socialLinks\":[{\"icon\":{\"svg\":\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"512\\\" height=\\\"512\\\" viewBox=\\\"0 0 512 512\\\"><title>RSS订阅</title><path d=\\\"M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z\\\"/><path d=\\\"M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z\\\"/><path d=\\\"M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z\\\"/></svg>\"},\"link\":\"/feed.xml\"}],\"footer\":{\"message\":\"<a href=\\\"https://github.com/Justin3go/justin3go.github.io\\\" target=\\\"_blank\\\">网站已开源，每周末如有更新release一次，欢迎star</a>\",\"copyright\":\"<a href=\\\"https://beian.miit.gov.cn/#/Integrated/index\\\" target=\\\"_blank\\\">Copyright© 2021-present 渝ICP备2021006879号</a>\"},\"search\":{\"provider\":\"local\"},\"editLink\":{\"pattern\":\"https://github.com/Justin3go/justin3go.github.io/edit/master/docs/:path\",\"text\":\"在GitHub上编辑此页\"},\"returnToTopLabel\":\"👆Code is building the world.\",\"sidebarMenuLabel\":\"目录\",\"darkModeSwitchLabel\":\"深色模式\",\"docFooter\":{\"prev\":false,\"next\":false},\"footerConfig\":{\"showFooter\":true,\"showRainbow\":true,\"icpRecordCode\":\"津ICP备2022005864号-2\",\"publicSecurityRecordCode\":\"津公网安备12011202000677号\",\"copyright\":\"Copyright © 2019-2025 Charles7c\"}},\"locales\":{\"root\":{\"label\":\"简体中文\"},\"en\":{\"label\":\"English\",\"link\":\"https://en.justin3go.com\"}},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>